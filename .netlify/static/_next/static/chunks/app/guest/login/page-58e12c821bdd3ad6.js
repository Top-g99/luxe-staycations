(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3559],{52418:(e,o,t)=>{"use strict";t.r(o),t.d(o,{default:()=>j});var n=t(95155),s=t(12115),r=t(97322),a=t(80851),i=t(23315),l=t(29767),c=t(84578),d=t(78010),u=t(9562),g=t(56422),p=t(41983),h=t(70690),x=t(21067),m=t(37881),y=t(51611),b=t(68212),k=t(42063),f=t(36944),I=t(20063),A=t(85903);function j(){let e=(0,I.useRouter)(),{allBookings:o,getBookingById:t}=(0,A.s)(),[j,v]=(0,s.useState)(""),[S,D]=(0,s.useState)(!1),[N,B]=(0,s.useState)(""),[E,P]=(0,s.useState)(!1),w=async()=>{B(""),P(!0);try{if(!j.trim()){B("Please enter your booking ID"),P(!1);return}let o=t(j.trim());if(!o){B("Invalid booking ID. Please check and try again."),P(!1);return}localStorage.setItem("guestEmail",o.guestInfo.email),localStorage.setItem("currentBookingId",j.trim()),e.push("/guest/dashboard")}catch(e){console.error("Login error:",e),B("An error occurred during login. Please try again.")}finally{P(!1)}};return(0,n.jsxs)(r.A,{maxWidth:"sm",sx:{py:8},children:[(0,n.jsxs)(a.A,{sx:{textAlign:"center",mb:4},children:[(0,n.jsx)(m.A,{sx:{fontSize:64,color:"#d97706",mb:2}}),(0,n.jsx)(i.A,{variant:"h3",sx:{fontWeight:600,color:"#5a3d35",mb:2},children:"Manage My Booking"}),(0,n.jsx)(i.A,{variant:"h6",sx:{color:"text.secondary"},children:"Access your booking details and manage your stay"})]}),(0,n.jsx)(l.A,{sx:{border:"2px solid #f3f4f6"},children:(0,n.jsxs)(c.A,{sx:{p:4},children:[(0,n.jsx)(i.A,{variant:"h5",sx:{mb:3,fontWeight:600,color:"#d97706",textAlign:"center"},children:"Login with Booking ID"}),N&&(0,n.jsx)(d.A,{severity:"error",sx:{mb:3},children:N}),(0,n.jsx)(a.A,{sx:{mb:3},children:(0,n.jsx)(u.A,{fullWidth:!0,label:"Booking ID",value:j,onChange:e=>v(e.target.value),placeholder:"Enter your booking ID",onKeyPress:e=>{"Enter"===e.key&&w()},InputProps:{startAdornment:(0,n.jsx)(g.A,{position:"start",children:(0,n.jsx)(y.A,{sx:{color:"text.secondary"}})}),endAdornment:(0,n.jsx)(g.A,{position:"end",children:(0,n.jsx)(p.A,{onClick:()=>D(!S),edge:"end",children:S?(0,n.jsx)(b.A,{}):(0,n.jsx)(k.A,{})})})},type:S?"text":"password",helperText:"Enter your unique booking ID (same as password)"})}),(0,n.jsx)(h.A,{fullWidth:!0,variant:"contained",onClick:w,disabled:E||!j.trim(),sx:{py:2,background:"linear-gradient(45deg, #5a3d35, #d97706)","&:hover":{background:"linear-gradient(45deg, #4a332c, #b45309)"}},children:E?"Accessing Booking...":"Access My Booking"}),(0,n.jsx)(x.A,{sx:{my:3},children:(0,n.jsx)(i.A,{variant:"body2",sx:{color:"text.secondary"},children:"OR"})}),(0,n.jsx)(h.A,{fullWidth:!0,variant:"outlined",onClick:()=>e.push("/"),startIcon:(0,n.jsx)(f.A,{}),children:"Browse Properties"})]})}),(0,n.jsx)(l.A,{sx:{mt:3,border:"2px solid #f3f4f6"},children:(0,n.jsxs)(c.A,{children:[(0,n.jsx)(i.A,{variant:"h6",sx:{mb:2,fontWeight:600,color:"#d97706"},children:"How to Find Your Booking ID"}),(0,n.jsx)(i.A,{variant:"body2",sx:{mb:2,color:"text.secondary"},children:"Your booking ID can be found in:"}),(0,n.jsxs)(a.A,{component:"ul",sx:{pl:2,mb:2},children:[(0,n.jsxs)(i.A,{component:"li",variant:"body2",sx:{color:"text.secondary",mb:1},children:[(0,n.jsx)("strong",{children:"Confirmation Email:"})," Sent to your email after booking"]}),(0,n.jsxs)(i.A,{component:"li",variant:"body2",sx:{color:"text.secondary",mb:1},children:[(0,n.jsx)("strong",{children:"Booking Confirmation Page:"})," Displayed after payment completion"]}),(0,n.jsxs)(i.A,{component:"li",variant:"body2",sx:{color:"text.secondary",mb:1},children:[(0,n.jsx)("strong",{children:"Booking Receipt:"})," Downloaded after booking confirmation"]})]}),(0,n.jsxs)(i.A,{variant:"body2",sx:{color:"text.secondary"},children:[(0,n.jsx)("strong",{children:"Format:"})," booking_1234567890_abc123def"]})]})}),(0,n.jsxs)(a.A,{sx:{textAlign:"center",mt:4},children:[(0,n.jsx)(i.A,{variant:"body2",sx:{color:"text.secondary",mb:1},children:"Need help accessing your booking?"}),(0,n.jsxs)(i.A,{variant:"body2",sx:{color:"text.secondary"},children:["Contact us at ",(0,n.jsx)("strong",{children:"support@luxestaycations.com"})," or call ",(0,n.jsx)("strong",{children:"+91-98765-43210"})]})]})]})}},61584:(e,o,t)=>{Promise.resolve().then(t.bind(t,52418))},85903:(e,o,t)=>{"use strict";t.d(o,{s:()=>i,v:()=>a});var n=t(95155),s=t(12115);let r=(0,s.createContext)(void 0);function a(e){let{children:o}=e,[a,i]=(0,s.useState)(null),[l,c]=(0,s.useState)({firstName:"",lastName:"",email:"",phone:"",address:"",city:"",country:"",specialRequests:""}),[d,u]=(0,s.useState)({checkIn:"",checkOut:"",guests:"",totalNights:0,total:0,propertyId:"",propertyName:"",propertyLocation:"",propertyImage:"",propertyPrice:0}),[g,p]=(0,s.useState)(null),[h,x]=(0,s.useState)([]);(0,s.useEffect)(()=>{{let e=localStorage.getItem("luxeBookings");if(e)try{x(JSON.parse(e))}catch(e){console.error("Error loading bookings from localStorage:",e)}}},[]),(0,s.useEffect)(()=>{localStorage.setItem("luxeBookings",JSON.stringify(h))},[h]);let m=async e=>{x(o=>[...o,e]),console.log("Booking added:",e);try{let o=await fetch("/api/bookings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({guestName:"".concat(e.guestInfo.firstName," ").concat(e.guestInfo.lastName),guestEmail:e.guestInfo.email,guestPhone:e.guestInfo.phone,propertyId:e.bookingDetails.propertyId,propertyName:e.bookingDetails.propertyName,checkIn:e.bookingDetails.checkIn,checkOut:e.bookingDetails.checkOut,guests:parseInt(e.bookingDetails.guests),amount:e.bookingDetails.total,status:e.status,paymentStatus:e.paymentStatus,specialRequests:e.guestInfo.specialRequests})});if(o.ok){let e=await o.json();console.log("Booking saved to Supabase:",e)}else console.error("Failed to save booking to Supabase:",await o.text())}catch(e){console.error("Error saving booking to Supabase:",e)}};return(0,n.jsx)(r.Provider,{value:{searchFormData:a,setSearchFormData:i,guestInfo:l,setGuestInfo:c,bookingDetails:d,setBookingDetails:u,completeBooking:g,setCompleteBooking:p,allBookings:h,addBooking:m,updateBooking:(e,o)=>{x(t=>t.map(t=>t.id===e?{...t,...o,updatedAt:new Date().toISOString()}:t)),console.log("Booking updated:",e,o),t.e(8991).then(t.bind(t,68991)).then(async t=>{let{bookingManager:n}=t;try{let t=await n.getById(e);if(t){var s,r,a,i,l,c,d,u;n.update(e,{guestName:o.guestInfo?"".concat(o.guestInfo.firstName||""," ").concat(o.guestInfo.lastName||"").trim():t.guestName,guestEmail:(null==(s=o.guestInfo)?void 0:s.email)||t.guestEmail,guestPhone:(null==(r=o.guestInfo)?void 0:r.phone)||t.guestPhone,property_id:(null==(a=o.bookingDetails)?void 0:a.propertyId)||t.property_id,checkIn:(null==(i=o.bookingDetails)?void 0:i.checkIn)||t.checkIn,checkOut:(null==(l=o.bookingDetails)?void 0:l.checkOut)||t.checkOut,guests:(null==(c=o.bookingDetails)?void 0:c.guests)?parseInt(o.bookingDetails.guests):"string"==typeof t.guests?parseInt(t.guests):t.guests,totalAmount:(null==(d=o.bookingDetails)?void 0:d.total)||t.totalAmount,status:"confirmed",specialRequests:(null==(u=o.guestInfo)?void 0:u.specialRequests)||t.specialRequests||""}),console.log("Successfully synced booking update to admin dashboard via DataManager")}}catch(e){console.error("Error syncing booking update to admin dashboard:",e)}})},getBookingById:e=>h.find(o=>o.id===e),clearBookingData:()=>{i(null),c({firstName:"",lastName:"",email:"",phone:"",address:"",city:"",country:"",specialRequests:""}),u({checkIn:"",checkOut:"",guests:"",totalNights:0,total:0,propertyId:"",propertyName:"",propertyLocation:"",propertyImage:"",propertyPrice:0}),p(null)},syncToAdminDashboard:()=>{console.log("Syncing booking data to admin dashboard..."),console.log("DataManager automatically handles Supabase sync and real-time updates")}},children:o})}function i(){let e=(0,s.useContext)(r);if(void 0===e)throw Error("useBookingContext must be used within a BookingProvider");return e}}},e=>{e.O(0,[5446,134,5493,5436,8020,2403,9562,4211,7056,8441,1255,7358],()=>e(e.s=61584)),_N_E=e.O()}]);