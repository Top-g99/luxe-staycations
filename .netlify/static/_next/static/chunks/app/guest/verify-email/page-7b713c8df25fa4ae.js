(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7618],{32683:(e,r,n)=>{"use strict";n.d(r,{A:()=>k});var t=n(67810),o=n(88945),i=n(12115),s=n(2821),a=n(57001),c=n(81852),l=n(48116),d=n(16625),u=n(43586),x=n(69582),h=n(23315),p=n(85795),A=n(95195);function m(e){return(0,A.Ay)("MuiLink",e)}let y=(0,p.A)("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]);var f=n(11041),v=n(1141);let g={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"};var j=n(95155);let b=["className","color","component","onBlur","onFocus","TypographyClasses","underline","variant","sx"],w=(0,l.Ay)(h.A,{name:"MuiLink",slot:"Root",overridesResolver:(e,r)=>{let{ownerState:n}=e;return[r.root,r["underline".concat((0,c.A)(n.underline))],"button"===n.component&&r.button]}})(e=>{let{theme:r,ownerState:n}=e;return(0,o.A)({},"none"===n.underline&&{textDecoration:"none"},"hover"===n.underline&&{textDecoration:"none","&:hover":{textDecoration:"underline"}},"always"===n.underline&&(0,o.A)({textDecoration:"underline"},"inherit"!==n.color&&{textDecorationColor:(e=>{let{theme:r,ownerState:n}=e,t=(e=>g[e]||e)(n.color),o=(0,f.Yn)(r,"palette.".concat(t),!1)||n.color,i=(0,f.Yn)(r,"palette.".concat(t,"Channel"));return"vars"in r&&i?"rgba(".concat(i," / 0.4)"):(0,v.X4)(o,.4)})({theme:r,ownerState:n})},{"&:hover":{textDecorationColor:"inherit"}}),"button"===n.component&&{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},["&.".concat(y.focusVisible)]:{outline:"auto"}})}),k=i.forwardRef(function(e,r){let n=(0,d.b)({props:e,name:"MuiLink"}),{className:l,color:h="primary",component:p="a",onBlur:A,onFocus:y,TypographyClasses:f,underline:v="always",variant:k="inherit",sx:C}=n,S=(0,t.A)(n,b),{isFocusVisibleRef:N,onBlur:M,onFocus:L,ref:R}=(0,u.A)(),[T,V]=i.useState(!1),z=(0,x.A)(r,R),P=(0,o.A)({},n,{color:h,component:p,focusVisible:T,underline:v,variant:k}),E=(e=>{let{classes:r,component:n,focusVisible:t,underline:o}=e,i={root:["root","underline".concat((0,c.A)(o)),"button"===n&&"button",t&&"focusVisible"]};return(0,a.A)(i,m,r)})(P);return(0,j.jsx)(w,(0,o.A)({color:h,className:(0,s.A)(E.root,l),classes:f,component:p,onBlur:e=>{M(e),!1===N.current&&V(!1),A&&A(e)},onFocus:e=>{L(e),!0===N.current&&V(!0),y&&y(e)},ref:z,ownerState:P,variant:k,sx:[...Object.keys(g).includes(h)?[]:[{color:h}],...Array.isArray(C)?C:[C]]},S))})},36741:(e,r,n)=>{"use strict";n.d(r,{A:()=>i});var t=n(15485),o=n(95155);let i=(0,t.A)((0,o.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle")},48563:(e,r,n)=>{"use strict";n.d(r,{A:()=>i});var t=n(15485),o=n(95155);let i=(0,t.A)((0,o.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"}),"Error")},76530:(e,r,n)=>{"use strict";n.d(r,{A:()=>i});var t=n(15485),o=n(95155);let i=(0,t.A)((0,o.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"}),"Refresh")},84578:(e,r,n)=>{"use strict";n.d(r,{A:()=>m});var t=n(88945),o=n(67810),i=n(12115),s=n(2821),a=n(57001),c=n(48116),l=n(16625),d=n(85795),u=n(95195);function x(e){return(0,u.Ay)("MuiCardContent",e)}(0,d.A)("MuiCardContent",["root"]);var h=n(95155);let p=["className","component"],A=(0,c.Ay)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,r)=>r.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),m=i.forwardRef(function(e,r){let n=(0,l.b)({props:e,name:"MuiCardContent"}),{className:i,component:c="div"}=n,d=(0,o.A)(n,p),u=(0,t.A)({},n,{component:c}),m=(e=>{let{classes:r}=e;return(0,a.A)({root:["root"]},x,r)})(u);return(0,h.jsx)(A,(0,t.A)({as:c,className:(0,s.A)(m.root,i),ownerState:u,ref:r},d))})},89141:(e,r,n)=>{Promise.resolve().then(n.bind(n,93741))},93741:(e,r,n)=>{"use strict";n.r(r),n.d(r,{default:()=>b});var t=n(95155),o=n(12115),i=n(20063),s=n(4474),a=n(97322),c=n(29767),l=n(84578),d=n(80851),u=n(23315),x=n(78010),h=n(70690),p=n(32683),A=n(36741),m=n(48563),y=n(30285),f=n(76530),v=n(52619),g=n.n(v);function j(){let e=(0,i.useSearchParams)(),[r,n]=(0,o.useState)("loading"),[v,j]=(0,o.useState)(""),[b,w]=(0,o.useState)("");(0,o.useEffect)(()=>{let r=e.get("token"),t=e.get("email");t&&w(t),r&&t?k(r,t):(n("error"),j("Invalid verification link"))},[e]);let k=async(e,r)=>{try{let t=await fetch("/api/guest/verify-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,email:r})}),o=await t.json();o.success?(n("success"),j("Your email has been verified successfully! Your Luxe Rewards account is now active.")):o.message.includes("expired")?(n("expired"),j("This verification link has expired. Please request a new one.")):(n("error"),j(o.message||"Verification failed"))}catch(e){n("error"),j("Network error. Please try again.")}},C=async()=>{if(b){n("loading");try{let e=await fetch("/api/guest/resend-verification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:b})}),r=await e.json();r.success?(j("A new verification email has been sent to your email address."),n("success")):(n("error"),j(r.message||"Failed to resend verification email"))}catch(e){n("error"),j("Network error. Please try again.")}}};return(0,t.jsx)(a.A,{maxWidth:"sm",sx:{py:8},children:(0,t.jsx)(c.A,{children:(0,t.jsxs)(l.A,{sx:{textAlign:"center",py:6},children:[(0,t.jsx)(d.A,{sx:{mb:3},children:(()=>{switch(r){case"success":return(0,t.jsx)(A.A,{sx:{fontSize:64,color:"success.main"}});case"error":case"expired":return(0,t.jsx)(m.A,{sx:{fontSize:64,color:"error.main"}});default:return(0,t.jsx)(s.A,{size:64})}})()}),(0,t.jsxs)(u.A,{variant:"h4",gutterBottom:!0,color:(()=>{switch(r){case"success":return"success";case"error":case"expired":return"error";default:return"info"}})()+".main",children:["loading"===r&&"Verifying Email...","success"===r&&"Email Verified!","error"===r&&"Verification Failed","expired"===r&&"Link Expired"]}),(0,t.jsx)(u.A,{variant:"body1",color:"text.secondary",sx:{mb:3},children:v}),"success"===r&&(0,t.jsxs)(d.A,{children:[(0,t.jsx)(x.A,{severity:"success",sx:{mb:3,textAlign:"left"},children:(0,t.jsxs)(u.A,{variant:"body2",children:[(0,t.jsx)("strong",{children:"Welcome to Luxe Rewards!"}),(0,t.jsx)("br",{}),"Your account is now active and you can start earning points on your next booking."]})}),(0,t.jsxs)(d.A,{sx:{display:"flex",gap:2,justifyContent:"center",flexWrap:"wrap"},children:[(0,t.jsx)(h.A,{variant:"contained",component:g(),href:"/guest/dashboard",sx:{bgcolor:"var(--primary-dark)","&:hover":{bgcolor:"var(--primary-light)"}},children:"Go to Dashboard"}),(0,t.jsx)(h.A,{variant:"outlined",component:g(),href:"/villas",children:"Browse Properties"})]})]}),"expired"===r&&(0,t.jsxs)(d.A,{children:[(0,t.jsx)(x.A,{severity:"warning",sx:{mb:3,textAlign:"left"},children:(0,t.jsx)(u.A,{variant:"body2",children:"Verification links expire after 24 hours for security reasons."})}),(0,t.jsx)(h.A,{variant:"contained",onClick:C,startIcon:(0,t.jsx)(y.A,{}),sx:{bgcolor:"var(--primary-dark)","&:hover":{bgcolor:"var(--primary-light)"}},children:"Resend Verification Email"})]}),"error"===r&&(0,t.jsxs)(d.A,{children:[(0,t.jsx)(x.A,{severity:"error",sx:{mb:3,textAlign:"left"},children:(0,t.jsx)(u.A,{variant:"body2",children:"There was an issue verifying your email. This could be due to an invalid or expired link."})}),(0,t.jsxs)(d.A,{sx:{display:"flex",gap:2,justifyContent:"center",flexWrap:"wrap"},children:[(0,t.jsx)(h.A,{variant:"contained",onClick:C,startIcon:(0,t.jsx)(f.A,{}),sx:{bgcolor:"var(--primary-dark)","&:hover":{bgcolor:"var(--primary-light)"}},children:"Try Again"}),(0,t.jsx)(h.A,{variant:"outlined",component:g(),href:"/guest/signup",children:"Sign Up Again"})]})]}),"loading"===r&&(0,t.jsx)(u.A,{variant:"body2",color:"text.secondary",children:"Please wait while we verify your email address..."}),(0,t.jsx)(d.A,{sx:{mt:4,pt:3,borderTop:"1px solid #e0e0e0"},children:(0,t.jsxs)(u.A,{variant:"body2",color:"text.secondary",children:["Need help?"," ",(0,t.jsx)(p.A,{component:g(),href:"/contact-us",children:"Contact our support team"})]})})]})})})}function b(){return(0,t.jsx)(o.Suspense,{fallback:(0,t.jsx)(a.A,{maxWidth:"sm",sx:{py:8},children:(0,t.jsx)(c.A,{children:(0,t.jsxs)(l.A,{sx:{textAlign:"center",py:6},children:[(0,t.jsx)(s.A,{size:64}),(0,t.jsx)(u.A,{variant:"h4",sx:{mt:2},children:"Loading..."})]})})}),children:(0,t.jsx)(j,{})})}}},e=>{e.O(0,[5446,134,5493,5436,7247,4211,4423,8441,1255,7358],()=>e(e.s=89141)),_N_E=e.O()}]);