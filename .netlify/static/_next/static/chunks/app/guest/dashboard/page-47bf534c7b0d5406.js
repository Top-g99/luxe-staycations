(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4374],{8245:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var n=s(15485),o=s(95155);let i=(0,n.A)((0,o.jsx)("path",{d:"m2 22 14-5-9-9zm12.53-9.47 5.59-5.59c.49-.49 1.28-.49 1.77 0l.59.59 1.06-1.06-.59-.59c-1.07-1.07-2.82-1.07-3.89 0l-5.59 5.59zm-4.47-5.65-.59.59 1.06 1.06.59-.59c1.07-1.07 1.07-2.82 0-3.89l-.59-.59-1.06 1.07.59.59c.48.48.48 1.28 0 1.76m7 5-1.59 1.59 1.06 1.06 1.59-1.59c.49-.49 1.28-.49 1.77 0l1.61 1.61 1.06-1.06-1.61-1.61c-1.08-1.07-2.82-1.07-3.89 0m-2-6-3.59 3.59 1.06 1.06 3.59-3.59c1.07-1.07 1.07-2.82 0-3.89l-1.59-1.59-1.06 1.06 1.59 1.59c.48.49.48 1.29 0 1.77"}),"Celebration")},12857:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var n=s(15485),o=s(95155);let i=(0,n.A)((0,o.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"}),"Cancel")},23325:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var n=s(15485),o=s(95155);let i=(0,n.A)([(0,o.jsx)("circle",{cx:"4.5",cy:"9.5",r:"2.5"},"0"),(0,o.jsx)("circle",{cx:"9",cy:"5.5",r:"2.5"},"1"),(0,o.jsx)("circle",{cx:"15",cy:"5.5",r:"2.5"},"2"),(0,o.jsx)("circle",{cx:"19.5",cy:"9.5",r:"2.5"},"3"),(0,o.jsx)("path",{d:"M17.34 14.86c-.87-1.02-1.6-1.89-2.48-2.91-.46-.54-1.05-1.08-1.75-1.32-.11-.04-.22-.07-.33-.09-.25-.04-.52-.04-.78-.04s-.53 0-.79.05c-.11.02-.22.05-.33.09-.7.24-1.28.78-1.75 1.32-.87 1.02-1.6 1.89-2.48 2.91-1.31 1.31-2.92 2.76-2.62 4.79.29 1.02 1.02 2.03 2.33 2.32.73.15 3.06-.44 5.54-.44h.18c2.48 0 4.81.58 5.54.44 1.31-.29 2.04-1.31 2.33-2.32.31-2.04-1.3-3.49-2.61-4.8"},"4")],"Pets")},28121:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var n=s(15485),o=s(95155);let i=(0,n.A)((0,o.jsx)("path",{d:"m17 7-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4z"}),"Logout")},37881:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var n=s(15485),o=s(95155);let i=(0,n.A)((0,o.jsx)("path",{d:"M17 1H7c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2M7 18V6h10v12zm9-7V9.14C16 8.51 15.55 8 15 8H9c-.55 0-1 .51-1 1.14v1.96c.55 0 1 .45 1 1s-.45 1-1 1v1.76c0 .63.45 1.14 1 1.14h6c.55 0 1-.51 1-1.14V13c-.55 0-1-.45-1-1s.45-1 1-1m-3.5 3.5h-1v-1h1zm0-2h-1v-1h1zm0-2h-1v-1h1z"}),"BookOnline")},41004:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>ed});var n=s(95155),o=s(12115),i=s(97322),r=s(80851),a=s(23315),l=s(70690),c=s(29767),d=s(84578),u=s(33077),h=s(9562),m=s(55369),g=s(26466),x=s(78010),p=s(28548),y=s(41602),A=s(92025),f=s(49501),j=s(17681),b=s(48833),v=s(52363),k=s(65036),S=s(75912),C=s(28121),w=s(51611),I=s(75854),D=s(96917),P=s(65629),E=s(56350),B=s(37881),L=s(91393),q=s(8245),R=s(12857),z=s(62291),M=s(15485);let W=(0,M.A)((0,n.jsx)("path",{d:"M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2m-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1M9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m11 15H4v-2h16zm0-5H4V8h5.08L7 10.83 8.62 12 11 8.76l1-1.36 1 1.36L15.38 12 17 10.83 14.92 8H20z"}),"CardGiftcard");var N=s(20063),T=s(85903),H=s(4474);function O(e){let{children:t}=e,s=(0,N.useRouter)(),{getBookingById:i}=(0,T.s)(),[c,d]=(0,o.useState)(!1),[u,h]=(0,o.useState)(!0);return((0,o.useEffect)(()=>{let e=localStorage.getItem("guestEmail"),t=localStorage.getItem("currentBookingId");if(e&&t){let n=i(t);n&&n.guestInfo.email===e?d(!0):(localStorage.removeItem("guestEmail"),localStorage.removeItem("currentBookingId"),s.push("/guest/login"))}else s.push("/guest/login");h(!1)},[s,i]),u)?(0,n.jsxs)(r.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",gap:2},children:[(0,n.jsx)(H.A,{size:60,sx:{color:"#d97706"}}),(0,n.jsx)(a.A,{variant:"h6",sx:{color:"#5a3d35"},children:"Verifying your booking access..."})]}):c?(0,n.jsx)(n.Fragment,{children:t}):(0,n.jsxs)(r.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",gap:3,p:3},children:[(0,n.jsx)(B.A,{sx:{fontSize:80,color:"#d97706"}}),(0,n.jsx)(a.A,{variant:"h4",sx:{fontWeight:600,color:"#5a3d35",textAlign:"center"},children:"Access Denied"}),(0,n.jsx)(x.A,{severity:"warning",sx:{maxWidth:400},children:"You need to log in with your booking ID to access this page."}),(0,n.jsx)(l.A,{variant:"contained",onClick:()=>s.push("/guest/login"),sx:{background:"linear-gradient(45deg, #5a3d35, #d97706)","&:hover":{background:"linear-gradient(45deg, #4a332c, #b45309)"}},children:"Go to Login"})]})}var F=s(41983),V=s(21067),_=s(52641),J=s(95436),U=s(88450),G=s(86973),Y=s(99944),K=s(22822),Z=s(97688),Q=s(48457),X=s(47695);let $=(0,M.A)((0,n.jsx)("path",{d:"M12 22c4.97 0 9-4.03 9-9-4.97 0-9 4.03-9 9M5.6 10.25c0 1.38 1.12 2.5 2.5 2.5.53 0 1.01-.16 1.42-.44l-.02.19c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5l-.02-.19c.4.28.89.44 1.42.44 1.38 0 2.5-1.12 2.5-2.5 0-1-.59-1.85-1.43-2.25.84-.4 1.43-1.25 1.43-2.25 0-1.38-1.12-2.5-2.5-2.5-.53 0-1.01.16-1.42.44l.02-.19C14.5 2.12 13.38 1 12 1S9.5 2.12 9.5 3.5l.02.19c-.4-.28-.89-.44-1.42-.44-1.38 0-2.5 1.12-2.5 2.5 0 1 .59 1.85 1.43 2.25-.84.4-1.43 1.25-1.43 2.25M12 5.5c1.38 0 2.5 1.12 2.5 2.5s-1.12 2.5-2.5 2.5S9.5 9.38 9.5 8s1.12-2.5 2.5-2.5M3 13c0 4.97 4.03 9 9 9 0-4.97-4.03-9-9-9"}),"LocalFlorist"),ee=(0,M.A)((0,n.jsx)("path",{d:"M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3z"}),"MusicNote"),et=(0,M.A)([(0,n.jsx)("path",{d:"M11.23 6c-1.66 0-3.22.66-4.36 1.73C6.54 6.73 5.61 6 4.5 6 3.12 6 2 7.12 2 8.5S3.12 11 4.5 11c.21 0 .41-.03.61-.08-.05.25-.09.51-.1.78-.18 3.68 2.95 6.68 6.68 6.27 2.55-.28 4.68-2.26 5.19-4.77.15-.71.15-1.4.06-2.06-.09-.6.38-1.13.99-1.13H22V6zM4.5 9c-.28 0-.5-.22-.5-.5s.22-.5.5-.5.5.22.5.5-.22.5-.5.5m6.5 6c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3"},"0"),(0,n.jsx)("circle",{cx:"11",cy:"12",r:"2"},"1")],"Sports"),es=(0,M.A)((0,n.jsx)("path",{d:"M16 4c0-1.11.89-2 2-2s2 .89 2 2-.89 2-2 2-2-.89-2-2m4 18v-6h2.5l-2.54-7.63C19.68 7.55 18.92 7 18.06 7h-.12c-.86 0-1.63.55-1.9 1.37l-.86 2.58c1.08.6 1.82 1.73 1.82 3.05v8zm-7.5-10.5c.83 0 1.5-.67 1.5-1.5s-.67-1.5-1.5-1.5S11 9.17 11 10s.67 1.5 1.5 1.5M5.5 6c1.11 0 2-.89 2-2s-.89-2-2-2-2 .89-2 2 .89 2 2 2m2 16v-7H9V9c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v6h1.5v7zm6.5 0v-4h1v-4c0-.82-.68-1.5-1.5-1.5h-2c-.82 0-1.5.68-1.5 1.5v4h1v4z"}),"FamilyRestroom");var en=s(23325);let eo=(0,M.A)((0,n.jsx)("path",{d:"M12 2c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m9 7h-6v13h-2v-6h-2v6H9V9H3V7h18z"}),"Accessibility");var ei=s(77073),er=s(86946);let ea={"auspicious-occasions":{label:"Auspicious Occasions",icon:(0,n.jsx)(q.A,{}),options:["Wedding Anniversary","Birthday Celebration","Engagement Party","Baby Shower","Graduation Party","Corporate Event","Religious Ceremony","Festival Celebration","Reunion Party","Other Special Occasion"]},"food-preferences":{label:"Food & Dining Preferences",icon:(0,n.jsx)(Z.A,{}),options:["Vegetarian Meals","Vegan Options","Gluten-Free Diet","Halal Food","Kosher Food","Jain Food","Diabetic-Friendly","Nut-Free Options","Seafood Preferences","Spice Level Preferences","Breakfast in Bed","Private Chef","Wine Pairing","Local Cuisine Experience","Custom Menu"]},"business-needs":{label:"Business & Industry",icon:(0,n.jsx)(Q.A,{}),options:["Meeting Room Setup","Conference Facilities","Video Conferencing","Presentation Equipment","Business Center Access","Secretarial Services","Transportation to Office","Corporate Catering","Team Building Activities","Client Entertainment","Workstation Setup","High-Speed Internet","Printing Services","Document Scanning","Business Lounge Access"]},"wellness-spa":{label:"Wellness & Spa",icon:(0,n.jsx)(X.A,{}),options:["Spa Treatment","Massage Therapy","Yoga Sessions","Meditation Classes","Fitness Training","Wellness Consultation","Aromatherapy","Hot Stone Therapy","Facial Treatment","Body Scrub","Wellness Package","Personal Trainer","Nutrition Consultation","Mindfulness Sessions","Detox Programs"]},"decoration-events":{label:"Decoration & Events",icon:(0,n.jsx)($,{}),options:["Flower Arrangements","Balloon Decorations","Candle Setup","Theme Decoration","Lighting Setup","Table Centerpieces","Welcome Banners","Photo Booth","Event Photography","Videography","DJ Services","Live Music","Dance Performance","Cultural Shows","Fireworks Display"]},entertainment:{label:"Entertainment",icon:(0,n.jsx)(ee,{}),options:["Live Music Performance","DJ Services","Karaoke Setup","Movie Screening","Gaming Console","Board Games","Card Games","Puzzle Activities","Art Classes","Cooking Classes","Wine Tasting","Cocktail Making","Dance Classes","Magic Show","Comedy Night"]},"sports-activities":{label:"Sports & Activities",icon:(0,n.jsx)(et,{}),options:["Swimming Pool Access","Tennis Court","Golf Course","Fitness Center","Cycling Tours","Hiking Trails","Water Sports","Adventure Activities","Yoga Classes","Pilates Sessions","Zumba Classes","Boxing Training","Rock Climbing","Kayaking","Fishing Trip"]},"family-kids":{label:"Family & Kids",icon:(0,n.jsx)(es,{}),options:["Kids Club Access","Babysitting Services","Children's Activities","Kids Menu","High Chair","Crib/Baby Cot","Child Safety Gates","Kids Pool","Playground Access","Educational Activities","Arts & Crafts","Story Time","Kids Entertainment","Family Games","Childcare Services"]},pets:{label:"Pet Services",icon:(0,n.jsx)(en.A,{}),options:["Pet-Friendly Room","Pet Sitting Services","Pet Grooming","Pet Food","Pet Toys","Pet Walking Service","Veterinary Services","Pet Training","Pet Photography","Pet Spa Services","Pet-Friendly Areas","Pet Supplies","Pet Emergency Care","Pet Transportation","Pet Boarding"]},accessibility:{label:"Accessibility",icon:(0,n.jsx)(eo,{}),options:["Wheelchair Access","Accessible Bathroom","Hearing Impaired Support","Visual Impaired Support","Mobility Assistance","Accessible Transportation","Sign Language Interpreter","Braille Materials","Service Animal Support","Accessible Dining","Emergency Assistance","Medical Support","Accessible Activities","Companion Services","Accessibility Training"]}};function el(e){let{open:t,onClose:s,onSave:i,bookingId:c}=e,[d,m]=(0,o.useState)(""),[g,y]=(0,o.useState)([]),[A,f]=(0,o.useState)(""),[j,C]=(0,o.useState)("medium"),[w,I]=(0,o.useState)([]),D=()=>{I([]),m(""),y([]),f(""),C("medium"),s()};return(0,n.jsxs)(b.A,{open:t,onClose:D,maxWidth:"md",fullWidth:!0,children:[(0,n.jsxs)(v.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"2px solid #f3f4f6",pb:2},children:[(0,n.jsxs)(r.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,n.jsx)(q.A,{sx:{color:"#d97706"}}),(0,n.jsx)(a.A,{variant:"h6",sx:{fontWeight:600,color:"#5a3d35"},children:"Special Requests"})]}),(0,n.jsx)(F.A,{onClick:D,size:"small",children:(0,n.jsx)(ei.A,{})})]}),(0,n.jsxs)(k.A,{sx:{pt:3},children:[(0,n.jsx)(x.A,{severity:"info",sx:{mb:3},children:"Add special requests for your stay. These will be reviewed by our team and we'll do our best to accommodate your needs."}),(0,n.jsx)(a.A,{variant:"h6",sx:{mb:2,fontWeight:600,color:"#d97706"},children:"Select Request Category"}),(0,n.jsx)(u.Ay,{container:!0,spacing:2,sx:{mb:3},children:Object.entries(ea).map(e=>{let[t,s]=e;return(0,n.jsx)(u.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,n.jsx)(l.A,{fullWidth:!0,variant:d===t?"contained":"outlined",onClick:()=>{m(t),y([])},startIcon:s.icon,sx:{justifyContent:"flex-start",py:2,...d===t&&{background:"linear-gradient(45deg, #5a3d35, #d97706)","&:hover":{background:"linear-gradient(45deg, #4a332c, #b45309)"}}},children:s.label})},t)})}),d&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(V.A,{sx:{my:3}}),(0,n.jsxs)(r.A,{sx:{mb:3},children:[(0,n.jsx)(a.A,{variant:"h6",sx:{mb:2,fontWeight:600,color:"#d97706"},children:"Priority Level"}),(0,n.jsxs)(_.A,{fullWidth:!0,children:[(0,n.jsx)(J.A,{children:"Priority"}),(0,n.jsxs)(U.A,{value:j,onChange:e=>C(e.target.value),label:"Priority",children:[(0,n.jsx)(G.A,{value:"low",children:"Low Priority"}),(0,n.jsx)(G.A,{value:"medium",children:"Medium Priority"}),(0,n.jsx)(G.A,{value:"high",children:"High Priority"})]})]})]}),(0,n.jsxs)(r.A,{sx:{mb:3},children:[(0,n.jsx)(a.A,{variant:"h6",sx:{mb:2,fontWeight:600,color:"#d97706"},children:"Select Options"}),(0,n.jsx)(u.Ay,{container:!0,spacing:1,children:ea[d].options.map(e=>(0,n.jsx)(u.Ay,{item:!0,xs:12,sm:6,children:(0,n.jsx)(Y.A,{control:(0,n.jsx)(K.A,{checked:g.includes(e),onChange:()=>{y(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},color:"primary"}),label:e})},e))})]}),(0,n.jsxs)(r.A,{sx:{mb:3},children:[(0,n.jsx)(a.A,{variant:"h6",sx:{mb:2,fontWeight:600,color:"#d97706"},children:"Custom Request"}),(0,n.jsx)(h.A,{fullWidth:!0,multiline:!0,rows:3,label:"Additional details or custom request",value:A,onChange:e=>f(e.target.value),placeholder:"Please describe any additional requirements or special requests...",helperText:"Optional: Add any specific details or custom requests not covered above"})]}),(0,n.jsx)(l.A,{variant:"contained",startIcon:(0,n.jsx)(er.A,{}),onClick:()=>{let e=[];g.forEach(t=>{e.push({id:"req_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),type:"predefined",category:d,title:t,description:"Request for: ".concat(t),priority:j,status:"pending",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})}),A.trim()&&e.push({id:"req_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),type:"custom",category:d||"other",title:"Custom Request",description:A.trim(),priority:j,status:"pending",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),I(t=>[...t,...e]),m(""),y([]),f(""),C("medium")},disabled:0===g.length&&!A.trim(),sx:{background:"linear-gradient(45deg, #5a3d35, #d97706)","&:hover":{background:"linear-gradient(45deg, #4a332c, #b45309)"}},children:"Add Requests"})]}),w.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(V.A,{sx:{my:3}}),(0,n.jsxs)(a.A,{variant:"h6",sx:{mb:2,fontWeight:600,color:"#d97706"},children:["Added Requests (",w.length,")"]}),(0,n.jsx)(r.A,{sx:{display:"flex",flexDirection:"column",gap:1},children:w.map(e=>(0,n.jsxs)(r.A,{sx:{p:2,border:"1px solid #e9ecef",borderRadius:1,bgcolor:"#f8f9fa",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsxs)(r.A,{children:[(0,n.jsx)(a.A,{variant:"body1",sx:{fontWeight:600},children:e.title}),(0,n.jsx)(a.A,{variant:"body2",sx:{color:"text.secondary"},children:e.description}),(0,n.jsxs)(r.A,{sx:{mt:1},children:[(0,n.jsx)(p.A,{label:e.category.replace("-"," "),size:"small",sx:{mr:1}}),(0,n.jsx)(p.A,{label:e.priority,color:(e=>{switch(e){case"high":return"error";case"medium":return"warning";case"low":return"success";default:return"default"}})(e.priority),size:"small"})]})]}),(0,n.jsx)(l.A,{size:"small",color:"error",onClick:()=>{var t;return t=e.id,void I(e=>e.filter(e=>e.id!==t))},children:"Remove"})]},e.id))})]})]}),(0,n.jsxs)(S.A,{sx:{p:3,borderTop:"2px solid #f3f4f6"},children:[(0,n.jsx)(l.A,{onClick:D,variant:"outlined",children:"Cancel"}),(0,n.jsxs)(l.A,{onClick:()=>{i(w),s()},variant:"contained",disabled:0===w.length,sx:{background:"linear-gradient(45deg, #5a3d35, #d97706)","&:hover":{background:"linear-gradient(45deg, #4a332c, #b45309)"}},children:["Save Requests (",w.length,")"]})]})]})}var ec=s(62043);function ed(){var e,t;let s=(0,N.useRouter)(),{allBookings:M,getBookingById:H,updateBooking:F}=(0,T.s)(),[V,_]=(0,o.useState)(""),[J,U]=(0,o.useState)([]),[G,Y]=(0,o.useState)(!1),[K,Z]=(0,o.useState)(""),[Q,X]=(0,o.useState)("all"),[$,ee]=(0,o.useState)(!1),[et,es]=(0,o.useState)(null),[en,eo]=(0,o.useState)(!1),[ei,er]=(0,o.useState)(null),[ea,ed]=(0,o.useState)(0),[eu,eh]=(0,o.useState)(null),[em,eg]=(0,o.useState)(!1),[ex,ep]=(0,o.useState)([]),[ey,eA]=(0,o.useState)(null),[ef,ej]=(0,o.useState)("");(0,o.useEffect)(()=>{let e=localStorage.getItem("guestEmail"),t=localStorage.getItem("currentBookingId");if(e)_(e),eb(e),ev(e);else if(t){let e=H(t);e&&(_(e.guestInfo.email),eb(e.guestInfo.email),ev(e.guestInfo.email))}ek()},[H]);let eb=e=>{Y(!0),U(M.filter(t=>t.guestInfo.email.toLowerCase()===e.toLowerCase())),Y(!1)},ev=async e=>{try{let t=await fetch("/api/guest/profile?email=".concat(encodeURIComponent(e)));if(t.ok){let e=await t.json();e.success&&e.loyalty?(eh(e.loyalty),console.log("Loaded loyalty data from Supabase:",e.loyalty)):(console.log("No loyalty data found, creating default data"),eS())}else console.log("Guest account not found, creating default data"),eS()}catch(e){console.error("Error loading loyalty data:",e),eS()}},ek=async()=>{try{let e=await fetch("/api/loyalty/redemption-options");if(e.ok){let t=await e.json();t.success&&(ep(t.data||[]),console.log("Loaded redemption options:",t.data))}}catch(e){console.error("Error loading redemption options:",e)}},eS=()=>{let e=J[0];if(e){let t=J.reduce((e,t)=>e+(t.loyaltyPoints||0),0);eh({pointsBalance:t,tier:"bronze",totalSpent:Number(e.bookingDetails.total)||0,totalBookings:J.length,nextTierPoints:1e3,tierBenefits:["Basic support","Email notifications"],totalJewelsEarned:t,totalJewelsRedeemed:0})}},eC=async()=>{if(eu&&ey){if(ey.jewels_required>eu.pointsBalance)return void alert("Insufficient jewels balance for this redemption option");try{let e=localStorage.getItem("guestEmail");if(!e)return void alert("Please login first");let t=await fetch("/api/guest/profile?email="+encodeURIComponent(e)),s=await t.json();if(!s.success||!s.guest)return void alert("Guest account not found");let n=await fetch("/api/loyalty/redemption-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({guest_id:s.guest.id,jewels_to_redeem:ey.jewels_required,redemption_reason:ey.option_name,contact_preference:"email",special_notes:ef||""})}),o=await n.json();o.success?(alert('Redemption request submitted successfully! Your request for "'.concat(ey.option_name,'" is pending admin approval.')),eg(!1),eA(null),ej(""),ev(e)):alert("Redemption request failed: "+o.error)}catch(e){console.error("Redemption error:",e),alert("Redemption request failed. Please try again.")}}},ew=J.filter(e=>{let t=e.bookingDetails.propertyName.toLowerCase().includes(K.toLowerCase())||e.id.toLowerCase().includes(K.toLowerCase()),s="all"===Q||e.status===Q;return t&&s}),eI=async()=>{if(et)try{if(F(et.id,{status:"cancelled",updatedAt:new Date().toISOString()}),ec.gm.isConfigured){var e,t,s,n,o,i,r,a,l;let c={guestName:(null==(e=et.guestInfo)?void 0:e.name)||"Guest",guestEmail:(null==(t=et.guestInfo)?void 0:t.email)||V,bookingId:et.id,propertyName:(null==(s=et.bookingDetails)?void 0:s.propertyName)||"Luxury Villa",propertyAddress:(null==(n=et.bookingDetails)?void 0:n.propertyLocation)||"Premium Location",checkIn:(null==(o=et.bookingDetails)?void 0:o.checkIn)||"",checkOut:(null==(i=et.bookingDetails)?void 0:i.checkOut)||"",guests:parseInt((null==(r=et.bookingDetails)?void 0:r.guests)||"1"),totalAmount:parseFloat((null==(a=et.bookingDetails)?void 0:a.totalAmount)||"0"),cancellationReason:"Guest requested cancellation",refundAmount:.9*parseFloat((null==(l=et.bookingDetails)?void 0:l.totalAmount)||"0"),refundMethod:"Original payment method",refundTimeline:"5-7 business days",hostName:"Property Host",hostPhone:"+91-8828279739",hostEmail:"host@luxestaycations.in"};try{await ec.gm.sendBookingCancellation(c)}catch(e){console.error("Email sending failed:",e)}}eb(V),ee(!1),es(null)}catch(e){console.error("Error cancelling booking:",e)}},eD=e=>{er(e),eo(!0)},eP=async e=>{if(ei){if(F(ei.id,{guestInfo:{...ei.guestInfo,specialRequests:e.map(e=>e.description).join("; ")},updatedAt:new Date().toISOString()}),e.length>0){var t,s,n,o;let i={guestName:(null==(t=ei.guestInfo)?void 0:t.name)||"Guest",guestEmail:(null==(s=ei.guestInfo)?void 0:s.email)||V,phone:(null==(n=ei.guestInfo)?void 0:n.phone)||"",propertyName:(null==(o=ei.bookingDetails)?void 0:o.propertyName)||"Luxury Villa",requestType:e.map(e=>e.category).join(", "),description:e.map(e=>e.description).join("\n\n"),urgency:e.some(e=>"high"===e.priority)?"High":e.some(e=>"medium"===e.priority)?"Medium":"Low",requestId:"SR-"+Date.now()};try{console.log("Sending special request confirmation email via Brevo...");let e=await fetch("/api/brevo/special-request",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}),t=await e.json();console.log("Special request email result:",t),t.success||console.error("Special request email failed:",t.message)}catch(e){console.error("Email sending failed:",e)}}eb(V),eo(!1),er(null),alert("Special requests submitted successfully! You will receive a confirmation email shortly.")}},eE=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return(0,n.jsx)(O,{children:(0,n.jsxs)(i.A,{maxWidth:"lg",sx:{py:8},children:[(0,n.jsxs)(r.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[(0,n.jsx)(a.A,{variant:"h3",sx:{fontWeight:600,color:"#5a3d35"},children:"Guest Dashboard"}),(0,n.jsx)(l.A,{variant:"outlined",startIcon:(0,n.jsx)(C.A,{}),onClick:()=>void(localStorage.removeItem("guestEmail"),localStorage.removeItem("currentBookingId"),s.push("/guest/login")),sx:{borderColor:"#d97706",color:"#d97706"},children:"Logout"})]}),(0,n.jsx)(c.A,{sx:{mb:4,border:"2px solid #f3f4f6"},children:(0,n.jsxs)(d.A,{children:[(0,n.jsx)(a.A,{variant:"h6",sx:{mb:3,fontWeight:600,color:"#d97706"},children:"Find Your Bookings"}),(0,n.jsxs)(u.Ay,{container:!0,spacing:2,alignItems:"center",children:[(0,n.jsx)(u.Ay,{item:!0,xs:12,md:6,children:(0,n.jsx)(h.A,{fullWidth:!0,label:"Enter your email address",value:V,onChange:e=>_(e.target.value),placeholder:"john@example.com",type:"email"})}),(0,n.jsx)(u.Ay,{item:!0,xs:12,md:3,children:(0,n.jsxs)(l.A,{fullWidth:!0,variant:"contained",onClick:()=>void(V&&(localStorage.setItem("guestEmail",V),eb(V),ev(V))),disabled:!V,sx:{background:"linear-gradient(45deg, #5a3d35, #d97706)","&:hover":{background:"linear-gradient(45deg, #4a332c, #b45309)"}},children:[(0,n.jsx)(w.A,{sx:{mr:1}}),"Search Bookings"]})}),(0,n.jsx)(u.Ay,{item:!0,xs:12,md:3,children:(0,n.jsx)(l.A,{fullWidth:!0,variant:"outlined",onClick:()=>s.push("/"),children:"Browse Properties"})})]})]})}),(0,n.jsx)(r.A,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:(0,n.jsxs)(m.A,{value:ea,onChange:(e,t)=>ed(t),children:[(0,n.jsx)(g.A,{label:"My Bookings",icon:(0,n.jsx)(I.A,{})}),(0,n.jsx)(g.A,{label:"Special Requests",icon:(0,n.jsx)(D.A,{})}),(0,n.jsx)(g.A,{label:"\uD83D\uDC8E Luxe Jewels",icon:(0,n.jsx)(P.A,{})}),(0,n.jsx)(g.A,{label:"Profile",icon:(0,n.jsx)(E.A,{})})]})}),0===ea&&(0,n.jsxs)(n.Fragment,{children:[J.length>0&&(0,n.jsx)(r.A,{sx:{mb:3},children:(0,n.jsxs)(u.Ay,{container:!0,spacing:2,alignItems:"center",children:[(0,n.jsx)(u.Ay,{item:!0,xs:12,md:6,children:(0,n.jsx)(h.A,{fullWidth:!0,label:"Search bookings",value:K,onChange:e=>Z(e.target.value),placeholder:"Search by property name or booking ID",InputProps:{startAdornment:(0,n.jsx)(w.A,{sx:{color:"text.secondary",mr:1}})}})}),(0,n.jsx)(u.Ay,{item:!0,xs:12,md:3,children:(0,n.jsxs)(h.A,{fullWidth:!0,select:!0,label:"Filter by status",value:Q,onChange:e=>X(e.target.value),children:[(0,n.jsx)("option",{value:"all",children:"All Bookings"}),(0,n.jsx)("option",{value:"confirmed",children:"Confirmed"}),(0,n.jsx)("option",{value:"pending",children:"Pending"}),(0,n.jsx)("option",{value:"cancelled",children:"Cancelled"}),(0,n.jsx)("option",{value:"completed",children:"Completed"})]})}),(0,n.jsx)(u.Ay,{item:!0,xs:12,md:3,children:(0,n.jsxs)(a.A,{variant:"body2",sx:{color:"text.secondary"},children:[ew.length," booking",1!==ew.length?"s":""," found"]})})]})}),G?(0,n.jsx)(a.A,{children:"Loading your bookings..."}):0===J.length&&V?(0,n.jsx)(x.A,{severity:"info",children:"No bookings found for this email address. Please check your email or create a new booking."}):0===J.length?(0,n.jsx)(c.A,{sx:{border:"2px solid #f3f4f6"},children:(0,n.jsxs)(d.A,{sx:{textAlign:"center",py:8},children:[(0,n.jsx)(B.A,{sx:{fontSize:64,color:"text.secondary",mb:2}}),(0,n.jsx)(a.A,{variant:"h6",sx:{mb:2},children:"Welcome to Your Booking Dashboard"}),(0,n.jsx)(a.A,{variant:"body1",sx:{color:"text.secondary",mb:3},children:"Enter your email address above to view your bookings and manage your stays."}),(0,n.jsx)(l.A,{variant:"contained",onClick:()=>s.push("/"),sx:{background:"linear-gradient(45deg, #5a3d35, #d97706)","&:hover":{background:"linear-gradient(45deg, #4a332c, #b45309)"}},children:"Browse Properties"})]})}):(0,n.jsx)(u.Ay,{container:!0,spacing:3,children:ew.map(e=>(0,n.jsx)(u.Ay,{item:!0,xs:12,children:(0,n.jsx)(c.A,{sx:{border:"2px solid #f3f4f6"},children:(0,n.jsx)(d.A,{children:(0,n.jsxs)(u.Ay,{container:!0,spacing:3,children:[(0,n.jsx)(u.Ay,{item:!0,xs:12,sm:3,children:(0,n.jsx)(r.A,{component:"img",src:e.bookingDetails.propertyImage,alt:e.bookingDetails.propertyName,sx:{width:"100%",height:150,objectFit:"cover",borderRadius:2}})}),(0,n.jsxs)(u.Ay,{item:!0,xs:12,sm:6,children:[(0,n.jsx)(a.A,{variant:"h6",sx:{fontWeight:600,mb:1},children:e.bookingDetails.propertyName}),(0,n.jsx)(a.A,{variant:"body2",sx:{color:"text.secondary",mb:2},children:e.bookingDetails.propertyLocation}),(0,n.jsxs)(u.Ay,{container:!0,spacing:2,children:[(0,n.jsxs)(u.Ay,{item:!0,xs:6,children:[(0,n.jsxs)(r.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[(0,n.jsx)(I.A,{sx:{fontSize:16,color:"text.secondary"}}),(0,n.jsx)(a.A,{variant:"body2",sx:{color:"text.secondary"},children:"Check-in"})]}),(0,n.jsx)(a.A,{variant:"body1",sx:{fontWeight:600},children:eE(e.bookingDetails.checkIn)})]}),(0,n.jsxs)(u.Ay,{item:!0,xs:6,children:[(0,n.jsxs)(r.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[(0,n.jsx)(I.A,{sx:{fontSize:16,color:"text.secondary"}}),(0,n.jsx)(a.A,{variant:"body2",sx:{color:"text.secondary"},children:"Check-out"})]}),(0,n.jsx)(a.A,{variant:"body1",sx:{fontWeight:600},children:eE(e.bookingDetails.checkOut)})]})]}),(0,n.jsxs)(r.A,{sx:{mt:2},children:[(0,n.jsx)(p.A,{label:(e=>{switch(e){case"confirmed":return"Confirmed";case"pending":return"Pending";case"cancelled":return"Cancelled";case"completed":return"Completed";default:return e}})(e.status),color:(e=>{switch(e){case"confirmed":return"success";case"pending":return"warning";case"cancelled":return"error";case"completed":return"info";default:return"default"}})(e.status),size:"small"}),(0,n.jsxs)(a.A,{variant:"body2",sx:{color:"text.secondary",mt:1},children:["Booking ID: ",e.id]})]})]}),(0,n.jsx)(u.Ay,{item:!0,xs:12,sm:3,children:(0,n.jsxs)(r.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,n.jsxs)(a.A,{variant:"h6",sx:{fontWeight:600,color:"#d97706"},children:["₹",e.bookingDetails.total.toLocaleString()]}),e.loyaltyPoints&&e.loyaltyPoints>0&&(0,n.jsxs)(a.A,{variant:"body2",sx:{color:"#d97706",fontWeight:500},children:["\uD83D\uDC8E ",e.loyaltyPoints," Jewels Earned"]}),(0,n.jsx)(l.A,{variant:"outlined",size:"small",startIcon:(0,n.jsx)(L.A,{}),onClick:()=>s.push("/booking/confirmation/".concat(e.id)),children:"View Details"}),"confirmed"===e.status&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.A,{variant:"outlined",size:"small",startIcon:(0,n.jsx)(q.A,{}),onClick:()=>eD(e),sx:{mb:1},children:"Special Requests"}),(0,n.jsx)(l.A,{variant:"outlined",size:"small",startIcon:(0,n.jsx)(R.A,{}),color:"error",onClick:()=>{es(e),ee(!0)},children:"Cancel Booking"})]})]})})]})})})},e.id))})]}),1===ea&&(0,n.jsx)(c.A,{children:(0,n.jsxs)(d.A,{children:[(0,n.jsx)(a.A,{variant:"h6",sx:{fontWeight:600,color:"#5a3d35",mb:3},children:"Special Requests Management"}),(0,n.jsx)(a.A,{variant:"body1",sx:{color:"text.secondary",mb:3},children:"Manage special requests for your confirmed bookings. You can add dietary requirements, celebration arrangements, accessibility needs, and other special requests."}),J.filter(e=>"confirmed"===e.status).length>0?(0,n.jsx)(y.A,{children:J.filter(e=>"confirmed"===e.status).map(e=>(0,n.jsxs)(A.Ay,{sx:{border:"1px solid #e0e0e0",borderRadius:2,mb:2},children:[(0,n.jsx)(f.A,{children:(0,n.jsx)(D.A,{sx:{color:"#d97706"}})}),(0,n.jsx)(j.A,{primary:e.bookingDetails.propertyName,secondary:"Check-in: ".concat(eE(e.bookingDetails.checkIn)," | Check-out: ").concat(eE(e.bookingDetails.checkOut))}),(0,n.jsx)(l.A,{variant:"outlined",onClick:()=>eD(e),sx:{borderColor:"#d97706",color:"#d97706"},children:"Manage Requests"})]},e.id))}):(0,n.jsx)(x.A,{severity:"info",children:"No confirmed bookings available for special requests. Please confirm a booking first."})]})}),2===ea&&eu&&(0,n.jsxs)(u.Ay,{container:!0,spacing:3,children:[(0,n.jsx)(u.Ay,{item:!0,xs:12,md:4,children:(0,n.jsx)(c.A,{sx:{height:"100%",background:"linear-gradient(135deg, #5a3d35 0%, #d97706 100%)",color:"white"},children:(0,n.jsxs)(d.A,{sx:{textAlign:"center",py:4},children:[(0,n.jsx)(P.A,{sx:{fontSize:48,mb:2,color:"#FFD700"}}),(0,n.jsx)(a.A,{variant:"h2",sx:{fontWeight:"bold",mb:1},children:eu.pointsBalance}),(0,n.jsx)(a.A,{variant:"h6",sx:{mb:3},children:"Luxe Jewels"}),(0,n.jsx)(p.A,{label:"".concat((e=>{switch(e){case"bronze":return"\uD83E\uDD49";case"silver":return"\uD83E\uDD48";case"gold":return"\uD83E\uDD47";case"platinum":return"\uD83D\uDC8E";default:return"⭐"}})(eu.tier)," ").concat(eu.tier.toUpperCase()),color:(e=>{switch(e){case"bronze":default:return"default";case"silver":return"primary";case"gold":return"warning";case"platinum":return"success"}})(eu.tier),sx:{bgcolor:"rgba(255,255,255,0.2)",color:"white",mb:2}}),(0,n.jsx)(l.A,{variant:"contained",size:"large",onClick:()=>eg(!0),sx:{bgcolor:"#FFD700",color:"#5a3d35",fontWeight:600,"&:hover":{bgcolor:"#FFC107"}},children:"Redeem Jewels"})]})})}),(0,n.jsx)(u.Ay,{item:!0,xs:12,md:8,children:(0,n.jsx)(c.A,{sx:{height:"100%"},children:(0,n.jsxs)(d.A,{children:[(0,n.jsx)(a.A,{variant:"h6",sx:{fontWeight:600,color:"#5a3d35",mb:3},children:"Tier Progress"}),(0,n.jsxs)(r.A,{sx:{mb:3},children:[(0,n.jsxs)(r.A,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,n.jsx)(a.A,{variant:"body2",children:"Progress to next tier"}),(0,n.jsxs)(a.A,{variant:"body2",children:[eu.pointsBalance," / ",eu.nextTierPoints," points"]})]}),(0,n.jsx)(r.A,{sx:{width:"100%",height:8,bgcolor:"grey.200",borderRadius:4,overflow:"hidden"},children:(0,n.jsx)(r.A,{sx:{width:"".concat(Math.min(eu.pointsBalance/eu.nextTierPoints*100,100),"%"),height:"100%",bgcolor:"var(--primary-dark)",transition:"width 0.3s ease"}})})]}),(0,n.jsxs)(a.A,{variant:"body2",color:"text.secondary",children:[eu.nextTierPoints-eu.pointsBalance," more points to reach the next tier"]})]})})}),(0,n.jsx)(u.Ay,{item:!0,xs:12,children:(0,n.jsx)(c.A,{children:(0,n.jsxs)(d.A,{children:[(0,n.jsx)(a.A,{variant:"h6",sx:{fontWeight:600,color:"#5a3d35",mb:3},children:"Your Tier Benefits"}),(0,n.jsx)(u.Ay,{container:!0,spacing:2,children:eu.tierBenefits.map((e,t)=>(0,n.jsx)(u.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,n.jsxs)(r.A,{sx:{display:"flex",alignItems:"center",p:2,bgcolor:"grey.50",borderRadius:2},children:[(0,n.jsx)(z.A,{sx:{color:"#d97706",mr:1}}),(0,n.jsx)(a.A,{variant:"body2",children:e})]})},t))})]})})}),(0,n.jsx)(u.Ay,{item:!0,xs:12,md:6,children:(0,n.jsx)(c.A,{children:(0,n.jsxs)(d.A,{children:[(0,n.jsx)(a.A,{variant:"h6",sx:{fontWeight:600,color:"#5a3d35",mb:3},children:"How to Earn Jewels"}),(0,n.jsxs)(y.A,{children:[(0,n.jsxs)(A.Ay,{children:[(0,n.jsx)(f.A,{children:(0,n.jsx)(P.A,{sx:{color:"#d97706"}})}),(0,n.jsx)(j.A,{primary:"1 point per ₹100 spent",secondary:"Earn jewels on every booking"})]}),(0,n.jsxs)(A.Ay,{children:[(0,n.jsx)(f.A,{children:(0,n.jsx)(z.A,{sx:{color:"#d97706"}})}),(0,n.jsx)(j.A,{primary:"Referral bonus",secondary:"Earn 500 jewels for each successful referral"})]}),(0,n.jsxs)(A.Ay,{children:[(0,n.jsx)(f.A,{children:(0,n.jsx)(W,{sx:{color:"#d97706"}})}),(0,n.jsx)(j.A,{primary:"Special promotions",secondary:"Double jewels during special events"})]})]})]})})}),(0,n.jsx)(u.Ay,{item:!0,xs:12,md:6,children:(0,n.jsx)(c.A,{children:(0,n.jsxs)(d.A,{children:[(0,n.jsx)(a.A,{variant:"h6",sx:{fontWeight:600,color:"#5a3d35",mb:3},children:"How to Redeem Jewels"}),(0,n.jsxs)(y.A,{children:[(0,n.jsxs)(A.Ay,{children:[(0,n.jsx)(f.A,{children:(0,n.jsx)(P.A,{sx:{color:"#d97706"}})}),(0,n.jsx)(j.A,{primary:"Free nights",secondary:"Redeem 10,000 jewels for a free night"})]}),(0,n.jsxs)(A.Ay,{children:[(0,n.jsx)(f.A,{children:(0,n.jsx)(W,{sx:{color:"#d97706"}})}),(0,n.jsx)(j.A,{primary:"Upgrades",secondary:"Upgrade to premium rooms"})]}),(0,n.jsxs)(A.Ay,{children:[(0,n.jsx)(f.A,{children:(0,n.jsx)(z.A,{sx:{color:"#d97706"}})}),(0,n.jsx)(j.A,{primary:"Exclusive experiences",secondary:"Access to special events and services"})]})]})]})})})]}),3===ea&&(0,n.jsx)(c.A,{children:(0,n.jsxs)(d.A,{children:[(0,n.jsx)(a.A,{variant:"h6",sx:{fontWeight:600,color:"#5a3d35",mb:3},children:"Profile Information"}),(0,n.jsxs)(u.Ay,{container:!0,spacing:3,children:[(0,n.jsxs)(u.Ay,{item:!0,xs:12,md:6,children:[(0,n.jsx)(h.A,{fullWidth:!0,label:"Email Address",value:V,disabled:!0,sx:{mb:2}}),(0,n.jsx)(h.A,{fullWidth:!0,label:"Total Bookings",value:J.length,disabled:!0,sx:{mb:2}}),(0,n.jsx)(h.A,{fullWidth:!0,label:"Loyalty Tier",value:(null==eu||null==(e=eu.tier)?void 0:e.toUpperCase())||"BRONZE",disabled:!0})]}),(0,n.jsxs)(u.Ay,{item:!0,xs:12,md:6,children:[(0,n.jsx)(h.A,{fullWidth:!0,label:"Total Spent",value:"₹".concat((null==eu||null==(t=eu.totalSpent)?void 0:t.toLocaleString())||"0"),disabled:!0,sx:{mb:2}}),(0,n.jsx)(h.A,{fullWidth:!0,label:"Luxe Jewels Balance",value:(null==eu?void 0:eu.pointsBalance)||"0",disabled:!0,sx:{mb:2}}),(0,n.jsx)(h.A,{fullWidth:!0,label:"Member Since",value:new Date().toLocaleDateString(),disabled:!0})]})]})]})}),(0,n.jsxs)(b.A,{open:$,onClose:()=>ee(!1),children:[(0,n.jsx)(v.A,{children:"Cancel Booking"}),(0,n.jsxs)(k.A,{children:[(0,n.jsxs)(a.A,{children:["Are you sure you want to cancel your booking for"," ",(0,n.jsx)("strong",{children:null==et?void 0:et.bookingDetails.propertyName}),"?"]}),(0,n.jsx)(a.A,{variant:"body2",sx:{color:"text.secondary",mt:1},children:"This action cannot be undone. Please check the cancellation policy for refund details."})]}),(0,n.jsxs)(S.A,{children:[(0,n.jsx)(l.A,{onClick:()=>ee(!1),children:"Keep Booking"}),(0,n.jsx)(l.A,{onClick:()=>eI(),color:"error",variant:"contained",children:"Cancel Booking"})]})]}),(0,n.jsx)(el,{open:en,onClose:()=>eo(!1),onSave:eP,bookingId:(null==ei?void 0:ei.id)||""}),(0,n.jsxs)(b.A,{open:em,onClose:()=>eg(!1),maxWidth:"md",fullWidth:!0,children:[(0,n.jsx)(v.A,{sx:{color:"#5a3d35",fontWeight:600},children:"\uD83D\uDC8E Redeem Your Luxe Jewels"}),(0,n.jsxs)(k.A,{children:[(0,n.jsx)(a.A,{variant:"body1",sx:{mb:3,color:"text.secondary"},children:"Choose from available redemption options. Your request will be reviewed by our team."}),eu&&(0,n.jsx)(r.A,{sx:{mb:3,p:2,bgcolor:"grey.50",borderRadius:2},children:(0,n.jsxs)(a.A,{variant:"h6",sx:{color:"#5a3d35"},children:["Your Balance: ",eu.pointsBalance," Jewels"]})}),(0,n.jsx)(u.Ay,{container:!0,spacing:2,children:ex.map(e=>(0,n.jsx)(u.Ay,{item:!0,xs:12,sm:6,children:(0,n.jsx)(c.A,{sx:{cursor:"pointer",border:(null==ey?void 0:ey.id)===e.id?"2px solid #d97706":"1px solid #e0e0e0","&:hover":{borderColor:"#d97706"}},onClick:()=>eA(e),children:(0,n.jsxs)(d.A,{children:[(0,n.jsxs)(r.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1},children:[(0,n.jsx)(a.A,{variant:"h6",sx:{color:"#5a3d35",fontWeight:600},children:e.option_name}),(0,n.jsx)(p.A,{label:"".concat(e.jewels_required," Jewels"),color:"primary",size:"small"})]}),(0,n.jsx)(a.A,{variant:"body2",sx:{color:"text.secondary",mb:2},children:e.option_description}),(0,n.jsx)(p.A,{label:e.option_type.replace("_"," ").toUpperCase(),size:"small",variant:"outlined",color:"secondary"})]})})},e.id))}),ey&&(0,n.jsx)(r.A,{sx:{mt:3},children:(0,n.jsx)(h.A,{fullWidth:!0,multiline:!0,rows:3,label:"Special Notes (Optional)",placeholder:"Any special requests or notes for this redemption...",value:ef,onChange:e=>ej(e.target.value)})})]}),(0,n.jsxs)(S.A,{children:[(0,n.jsx)(l.A,{onClick:()=>eg(!1),children:"Cancel"}),(0,n.jsx)(l.A,{onClick:eC,variant:"contained",disabled:!ey,sx:{bgcolor:"#d97706","&:hover":{bgcolor:"#b8651a"}},children:"Submit Redemption Request"})]})]})]})})}},47695:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var n=s(15485),o=s(95155);let i=(0,n.A)([(0,o.jsx)("path",{d:"M8.55 12c-1.07-.71-2.25-1.27-3.53-1.61 1.28.34 2.46.9 3.53 1.61m10.43-1.61c-1.29.34-2.49.91-3.57 1.64 1.08-.73 2.28-1.3 3.57-1.64"},"0"),(0,o.jsx)("path",{d:"M15.49 9.63c-.18-2.79-1.31-5.51-3.43-7.63-2.14 2.14-3.32 4.86-3.55 7.63 1.28.68 2.46 1.56 3.49 2.63 1.03-1.06 2.21-1.94 3.49-2.63m-6.5 2.65c-.14-.1-.3-.19-.45-.29.15.11.31.19.45.29m6.42-.25c-.13.09-.27.16-.4.26.13-.1.27-.17.4-.26M12 15.45C9.85 12.17 6.18 10 2 10c0 5.32 3.36 9.82 8.03 11.49.63.23 1.29.4 1.97.51.68-.12 1.33-.29 1.97-.51C18.64 19.82 22 15.32 22 10c-4.18 0-7.85 2.17-10 5.45"},"1")],"Spa")},48457:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var n=s(15485),o=s(95155);let i=(0,n.A)((0,o.jsx)("path",{d:"M12 7V3H2v18h20V7zM6 19H4v-2h2zm0-4H4v-2h2zm0-4H4V9h2zm0-4H4V5h2zm4 12H8v-2h2zm0-4H8v-2h2zm0-4H8V9h2zm0-4H8V5h2zm10 12h-8v-2h2v-2h-2v-2h2v-2h-2V9h8zm-2-8h-2v2h2zm0 4h-2v2h2z"}),"Business")},51611:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var n=s(15485),o=s(95155);let i=(0,n.A)((0,o.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search")},56350:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var n=s(15485),o=s(95155);let i=(0,n.A)((0,o.jsx)("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6"}),"Settings")},56531:(e,t,s)=>{Promise.resolve().then(s.bind(s,41004))},62043:(e,t,s)=>{"use strict";s.d(t,{gm:()=>o});class n{static getInstance(){return n.instance||(n.instance=new n),n.instance}async initialize(){return Promise.resolve()}async sendEmail(e){try{return console.log("Sending email:",e),!0}catch(e){return console.error("Email sending failed:",e),!1}}async getTemplates(){return this.templates}async getTemplate(e){return this.templates.find(t=>t.id===e)||null}async createTemplate(e){let t={...e,id:Date.now().toString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return this.templates.push(t),t}async updateTemplate(e,t){let s=this.templates.findIndex(t=>t.id===e);return -1!==s?(this.templates[s]={...this.templates[s],...t,updated_at:new Date().toISOString()},this.templates[s]):null}async deleteTemplate(e){let t=this.templates.findIndex(t=>t.id===e);return -1!==t&&(this.templates.splice(t,1),!0)}getConfig(){return{smtpHost:"smtp.gmail.com",smtpPort:587,smtpSecure:!1,enableSSL:!1,smtpUser:"test@example.com",smtpPassword:"password",fromEmail:"noreply@luxestaycations.com",fromName:"Luxe Staycations",replyTo:"info@luxestaycations.com",testMode:!0,maxRetries:3,retryDelay:1e3}}async configure(e){return console.log("Configuring email service:",e),this.isConfigured=!0,!0}async reloadConfiguration(){console.log("Reloading email configuration")}async sendTestEmail(e){try{return{success:await this.sendEmail({to:e,subject:"Test Email - Luxe Staycations",content:"This is a test email from Luxe Staycations email service.",html:"<p>This is a test email from <strong>Luxe Staycations</strong> email service.</p>"})}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async sendBookingConfirmation(e){try{let t="Dear ".concat(e.guestName,", your booking ").concat(e.bookingId," for ").concat(e.propertyName," is confirmed. Check-in: ").concat(e.checkIn,", Check-out: ").concat(e.checkOut);return{success:await this.sendEmail({to:e.guestEmail,subject:"Booking Confirmation - Luxe Staycations",content:t,template:"booking-confirmation"})}}catch(e){return console.error("Booking confirmation email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async testConnection(){return console.log("Testing email connection..."),{success:!0,message:"Email connection test successful"}}async sendBookingCancellation(e){try{let t="Dear ".concat(e.guestName,", your booking ").concat(e.bookingId," has been cancelled. Refund will be processed within 5-7 business days.");return{success:await this.sendEmail({to:e.guestEmail,subject:"Booking Cancellation - Luxe Staycations",content:t,template:"booking-cancellation"})}}catch(e){return console.error("Booking cancellation email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async sendConsultationConfirmation(e){try{let t="Hi ".concat(e.name,", we have received your consultation request. Request ID: ").concat(e.requestId);return{success:await this.sendEmail({to:e.email,subject:"Consultation Request Confirmation - Luxe Staycations",content:t,template:"consultation-confirmation"})}}catch(e){return console.error("Consultation confirmation email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async sendSpecialRequestConfirmation(e){try{let t="Hi ".concat(e.guestName,", we have received your special request for ").concat(e.propertyName,". Request ID: ").concat(e.requestId);return{success:await this.sendEmail({to:e.email,subject:"Special Request Confirmation - Luxe Staycations",content:t,template:"special-request-confirmation"})}}catch(e){return console.error("Special request confirmation email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async sendContactFormThankYou(e){try{let t="Hi ".concat(e.name,", thank you for contacting us. We will get back to you soon.");return{success:await this.sendEmail({to:e.email,subject:"Thank You for Contacting Us - Luxe Staycations",content:t,template:"contact-thank-you"})}}catch(e){return console.error("Contact form thank you email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async sendPartnerRequestConfirmation(e){try{let t="Hi ".concat(e.contactName,", we have received your partner request for ").concat(e.businessName,". Request ID: ").concat(e.requestId);return{success:await this.sendEmail({to:e.email,subject:"Partner Request Confirmation - Luxe Staycations",content:t,template:"partner-request-confirmation"})}}catch(e){return console.error("Partner request confirmation email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async sendAdminNotification(e,t,s){try{let n="Admin notification: ".concat(e,". Data: ").concat(JSON.stringify(t));return{success:await this.sendEmail({to:s,subject:"Admin Notification - ".concat(e," - Luxe Staycations"),content:n,template:"admin-notification"})}}catch(e){return console.error("Admin notification email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}constructor(){this.templates=[],this.isConfigured=!1}}let o=n.getInstance()},75854:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var n=s(15485),o=s(95155);let i=(0,n.A)((0,o.jsx)("path",{d:"M20 3h-1V1h-2v2H7V1H5v2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 18H4V8h16z"}),"CalendarToday")},85903:(e,t,s)=>{"use strict";s.d(t,{s:()=>a,v:()=>r});var n=s(95155),o=s(12115);let i=(0,o.createContext)(void 0);function r(e){let{children:t}=e,[r,a]=(0,o.useState)(null),[l,c]=(0,o.useState)({firstName:"",lastName:"",email:"",phone:"",address:"",city:"",country:"",specialRequests:""}),[d,u]=(0,o.useState)({checkIn:"",checkOut:"",guests:"",totalNights:0,total:0,propertyId:"",propertyName:"",propertyLocation:"",propertyImage:"",propertyPrice:0}),[h,m]=(0,o.useState)(null),[g,x]=(0,o.useState)([]);(0,o.useEffect)(()=>{{let e=localStorage.getItem("luxeBookings");if(e)try{x(JSON.parse(e))}catch(e){console.error("Error loading bookings from localStorage:",e)}}},[]),(0,o.useEffect)(()=>{localStorage.setItem("luxeBookings",JSON.stringify(g))},[g]);let p=async e=>{x(t=>[...t,e]),console.log("Booking added:",e);try{let t=await fetch("/api/bookings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({guestName:"".concat(e.guestInfo.firstName," ").concat(e.guestInfo.lastName),guestEmail:e.guestInfo.email,guestPhone:e.guestInfo.phone,propertyId:e.bookingDetails.propertyId,propertyName:e.bookingDetails.propertyName,checkIn:e.bookingDetails.checkIn,checkOut:e.bookingDetails.checkOut,guests:parseInt(e.bookingDetails.guests),amount:e.bookingDetails.total,status:e.status,paymentStatus:e.paymentStatus,specialRequests:e.guestInfo.specialRequests})});if(t.ok){let e=await t.json();console.log("Booking saved to Supabase:",e)}else console.error("Failed to save booking to Supabase:",await t.text())}catch(e){console.error("Error saving booking to Supabase:",e)}};return(0,n.jsx)(i.Provider,{value:{searchFormData:r,setSearchFormData:a,guestInfo:l,setGuestInfo:c,bookingDetails:d,setBookingDetails:u,completeBooking:h,setCompleteBooking:m,allBookings:g,addBooking:p,updateBooking:(e,t)=>{x(s=>s.map(s=>s.id===e?{...s,...t,updatedAt:new Date().toISOString()}:s)),console.log("Booking updated:",e,t),s.e(8991).then(s.bind(s,68991)).then(async s=>{let{bookingManager:n}=s;try{let s=await n.getById(e);if(s){var o,i,r,a,l,c,d,u;n.update(e,{guestName:t.guestInfo?"".concat(t.guestInfo.firstName||""," ").concat(t.guestInfo.lastName||"").trim():s.guestName,guestEmail:(null==(o=t.guestInfo)?void 0:o.email)||s.guestEmail,guestPhone:(null==(i=t.guestInfo)?void 0:i.phone)||s.guestPhone,property_id:(null==(r=t.bookingDetails)?void 0:r.propertyId)||s.property_id,checkIn:(null==(a=t.bookingDetails)?void 0:a.checkIn)||s.checkIn,checkOut:(null==(l=t.bookingDetails)?void 0:l.checkOut)||s.checkOut,guests:(null==(c=t.bookingDetails)?void 0:c.guests)?parseInt(t.bookingDetails.guests):"string"==typeof s.guests?parseInt(s.guests):s.guests,totalAmount:(null==(d=t.bookingDetails)?void 0:d.total)||s.totalAmount,status:"confirmed",specialRequests:(null==(u=t.guestInfo)?void 0:u.specialRequests)||s.specialRequests||""}),console.log("Successfully synced booking update to admin dashboard via DataManager")}}catch(e){console.error("Error syncing booking update to admin dashboard:",e)}})},getBookingById:e=>g.find(t=>t.id===e),clearBookingData:()=>{a(null),c({firstName:"",lastName:"",email:"",phone:"",address:"",city:"",country:"",specialRequests:""}),u({checkIn:"",checkOut:"",guests:"",totalNights:0,total:0,propertyId:"",propertyName:"",propertyLocation:"",propertyImage:"",propertyPrice:0}),m(null)},syncToAdminDashboard:()=>{console.log("Syncing booking data to admin dashboard..."),console.log("DataManager automatically handles Supabase sync and real-time updates")}},children:t})}function a(){let e=(0,o.useContext)(i);if(void 0===e)throw Error("useBookingContext must be used within a BookingProvider");return e}},86946:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var n=s(15485),o=s(95155);let i=(0,n.A)((0,o.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},91393:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var n=s(15485),o=s(95155);let i=(0,n.A)((0,o.jsx)("path",{d:"M18 17H6v-2h12zm0-4H6v-2h12zm0-4H6V7h12zM3 22l1.5-1.5L6 22l1.5-1.5L9 22l1.5-1.5L12 22l1.5-1.5L15 22l1.5-1.5L18 22l1.5-1.5L21 22V2l-1.5 1.5L18 2l-1.5 1.5L15 2l-1.5 1.5L12 2l-1.5 1.5L9 2 7.5 3.5 6 2 4.5 3.5 3 2z"}),"Receipt")},96917:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var n=s(15485),o=s(95155);let i=(0,n.A)((0,o.jsx)("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-2 12H6v-2h12zm0-3H6V9h12zm0-3H6V6h12z"}),"Message")}},e=>{e.O(0,[5446,134,5493,5436,3077,7247,8548,8020,2403,9562,4211,835,872,3568,2686,3635,7922,8441,1255,7358],()=>e(e.s=56531)),_N_E=e.O()}]);