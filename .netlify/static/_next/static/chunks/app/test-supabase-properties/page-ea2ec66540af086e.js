(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5722],{37037:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>S});var s=r(95155),a=r(12115),i=r(80851),n=r(4474),o=r(23315),c=r(78010),l=r(33077),d=r(29767),h=r(84578),x=r(70690),p=r(28548),y=r(52641),A=r(95436),u=r(88450),j=r(86973),m=r(21067),b=r(41602),g=r(92025),v=r(17681),f=r(76530),P=r(89623);function S(){var e;let[t,r]=(0,a.useState)(null),[S,k]=(0,a.useState)(!1),[w,E]=(0,a.useState)(!1),[T,W]=(0,a.useState)(null),[C,I]=(0,a.useState)(""),[G,O]=(0,a.useState)([]);(0,a.useEffect)(()=>{R(),N()},[]);let R=async()=>{try{k(!0);let e=await fetch("/api/test-supabase-properties"),t=await e.json();t.success?(r(t.analysis),W({type:"info",text:"Found ".concat(t.analysis.totalProperties," properties in database")})):W({type:"error",text:t.error||"Failed to fetch analysis"})}catch(e){W({type:"error",text:"Error fetching analysis"})}finally{k(!1)}},N=async()=>{try{let e=await fetch("/api/villas"),t=await e.json();t.success&&O(t.data)}catch(e){console.error("Error fetching properties:",e)}},_=async()=>{if(!C)return void W({type:"error",text:"Please select a property to test"});try{E(!0);let e=await fetch("/api/test-supabase-properties",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({propertyId:C,testData:{highlights:["AI Generated Highlight 1","AI Generated Highlight 2"],neighborhood:{attractions:["AI Generated Attraction 1","AI Generated Attraction 2"],restaurants:["AI Generated Restaurant 1"],distanceToAirport:30,distanceToBeach:3,nearbyActivities:["AI Generated Activity 1","AI Generated Activity 2"]}}})}),t=await e.json();t.success?(W({type:"success",text:"Test data successfully saved to Supabase!"}),R()):W({type:"error",text:t.error||"Failed to save test data"})}catch(e){W({type:"error",text:"Error testing Supabase save"})}finally{E(!1)}};return S?(0,s.jsx)(i.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:400},children:(0,s.jsx)(n.A,{})}):(0,s.jsxs)(i.A,{sx:{p:4},children:[(0,s.jsx)(o.A,{variant:"h4",sx:{mb:3,fontWeight:600},children:"Supabase Properties Test"}),T&&(0,s.jsx)(c.A,{severity:T.type,sx:{mb:3},onClose:()=>W(null),children:T.text}),(0,s.jsxs)(l.Ay,{container:!0,spacing:3,children:[t&&(0,s.jsx)(l.Ay,{item:!0,xs:12,md:8,children:(0,s.jsx)(d.A,{children:(0,s.jsxs)(h.A,{children:[(0,s.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,s.jsx)(o.A,{variant:"h6",sx:{fontWeight:600},children:"Database Analysis"}),(0,s.jsx)(x.A,{variant:"outlined",size:"small",startIcon:(0,s.jsx)(f.A,{}),onClick:R,children:"Refresh"})]}),(0,s.jsxs)(l.Ay,{container:!0,spacing:2,sx:{mb:3},children:[(0,s.jsx)(l.Ay,{item:!0,xs:6,md:3,children:(0,s.jsxs)(i.A,{sx:{textAlign:"center",p:2,backgroundColor:"rgba(25, 118, 210, 0.1)",borderRadius:2},children:[(0,s.jsx)(o.A,{variant:"h4",sx:{fontWeight:700,color:"primary.main"},children:t.totalProperties}),(0,s.jsx)(o.A,{variant:"body2",color:"text.secondary",children:"Total Properties"})]})}),(0,s.jsx)(l.Ay,{item:!0,xs:6,md:3,children:(0,s.jsxs)(i.A,{sx:{textAlign:"center",p:2,backgroundColor:"rgba(76, 175, 80, 0.1)",borderRadius:2},children:[(0,s.jsx)(o.A,{variant:"h4",sx:{fontWeight:700,color:"success.main"},children:t.propertiesWithEnrichedData}),(0,s.jsx)(o.A,{variant:"body2",color:"text.secondary",children:"Enriched Properties"})]})}),(0,s.jsx)(l.Ay,{item:!0,xs:6,md:3,children:(0,s.jsxs)(i.A,{sx:{textAlign:"center",p:2,backgroundColor:"rgba(255, 152, 0, 0.1)",borderRadius:2},children:[(0,s.jsxs)(o.A,{variant:"h4",sx:{fontWeight:700,color:"warning.main"},children:[Math.round(t.propertiesWithEnrichedData/t.totalProperties*100),"%"]}),(0,s.jsx)(o.A,{variant:"body2",color:"text.secondary",children:"Enrichment Rate"})]})}),(0,s.jsx)(l.Ay,{item:!0,xs:6,md:3,children:(0,s.jsxs)(i.A,{sx:{textAlign:"center",p:2,backgroundColor:"rgba(156, 39, 176, 0.1)",borderRadius:2},children:[(0,s.jsx)(o.A,{variant:"h4",sx:{fontWeight:700,color:"secondary.main"},children:Object.values(t.enrichmentBreakdown).reduce((e,t)=>e+t,0)}),(0,s.jsx)(o.A,{variant:"body2",color:"text.secondary",children:"Total Enrichments"})]})})]}),(0,s.jsx)(o.A,{variant:"subtitle1",sx:{fontWeight:600,mb:2},children:"Enrichment Breakdown"}),(0,s.jsx)(l.Ay,{container:!0,spacing:1,children:Object.entries(t.enrichmentBreakdown).map(e=>{let[t,r]=e;return(0,s.jsx)(l.Ay,{item:!0,xs:6,sm:4,md:3,children:(0,s.jsx)(p.A,{label:"".concat(t,": ").concat(r),color:r>0?"primary":"default",variant:r>0?"filled":"outlined",size:"small"})},t)})})]})})}),(0,s.jsx)(l.Ay,{item:!0,xs:12,md:4,children:(0,s.jsx)(d.A,{children:(0,s.jsxs)(h.A,{children:[(0,s.jsx)(o.A,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Test Supabase Save"}),(0,s.jsxs)(y.A,{fullWidth:!0,sx:{mb:2},children:[(0,s.jsx)(A.A,{children:"Select Property"}),(0,s.jsx)(u.A,{value:C,onChange:e=>I(e.target.value),label:"Select Property",children:G.map(e=>(0,s.jsx)(j.A,{value:e.id,children:e.name},e.id))})]}),(0,s.jsx)(x.A,{fullWidth:!0,variant:"contained",onClick:_,disabled:w||!C,startIcon:w?(0,s.jsx)(n.A,{size:20}):(0,s.jsx)(P.A,{}),sx:{background:"linear-gradient(45deg, #5a3d35, #d97706)","&:hover":{background:"linear-gradient(45deg, #4a332c, #b45309)"}},children:w?"Testing...":"Test Save to Supabase"}),(0,s.jsx)(o.A,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:"This will add test enriched data to the selected property to verify Supabase integration."})]})})}),(null==t?void 0:t.sampleProperty)&&(0,s.jsx)(l.Ay,{item:!0,xs:12,children:(0,s.jsx)(d.A,{children:(0,s.jsxs)(h.A,{children:[(0,s.jsx)(o.A,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Sample Property Data Structure"}),(0,s.jsxs)(o.A,{variant:"body2",sx:{mb:1},children:[(0,s.jsx)("strong",{children:"Name:"})," ",t.sampleProperty.name]}),(0,s.jsxs)(o.A,{variant:"body2",sx:{mb:1},children:[(0,s.jsx)("strong",{children:"Location:"})," ",t.sampleProperty.location]}),(0,s.jsxs)(o.A,{variant:"body2",sx:{mb:1},children:[(0,s.jsx)("strong",{children:"Price:"})," â‚¹",null==(e=t.sampleProperty.price)?void 0:e.toLocaleString(),"/night"]}),(0,s.jsx)(m.A,{sx:{my:2}}),(0,s.jsx)(o.A,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:"Enriched Fields Present:"}),(0,s.jsx)(b.A,{dense:!0,children:Object.entries(t.sampleProperty).map(e=>{let[t,r]=e;return["images","specifications","neighborhood","pricing","highlights","policies","virtualTour","floorPlan"].includes(t)?(0,s.jsx)(g.Ay,{sx:{py:0},children:(0,s.jsx)(v.A,{primary:t,secondary:r?"Present":"Not present",secondaryTypographyProps:{color:r?"success.main":"text.secondary"}})},t):null})})]})})})]})]})}},68823:(e,t,r)=>{Promise.resolve().then(r.bind(r,37037))}},e=>{e.O(0,[5446,134,5493,5436,3077,7247,8548,8020,2403,835,7411,8441,1255,7358],()=>e(e.s=68823)),_N_E=e.O()}]);