(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3216],{13733:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>B});var o=n(95155),s=n(12115),a=n(97322),i=n(23315),r=n(78010),c=n(70690),l=n(80851),d=n(29767),u=n(84578),m=n(33077),g=n(73741),x=n(21067),h=n(28548),p=n(36741),f=n(30285),y=n(91393),k=n(61205),b=n(75854),A=n(78784),j=n(54741),I=n(23123),v=n(61563),S=n(654),D=n(36944),w=n(37881),C=n(20063),N=n(85903),E=n(62043);function B(){var e,t,n;let B=(0,C.useParams)(),L=(0,C.useRouter)(),{getBookingById:R}=(0,N.s)(),[P,O]=(0,s.useState)(null),[q,T]=(0,s.useState)(!0),[W,U]=(0,s.useState)("unknown");(0,s.useEffect)(()=>{let e=R(B.id);e&&(O(e),E.gm.isConfigured?U("sent"):U("not-configured")),T(!1)},[B.id,R]);let _=e=>new Date(e).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return q?(0,o.jsx)(a.A,{maxWidth:"lg",sx:{py:8},children:(0,o.jsx)(i.A,{children:"Loading booking confirmation..."})}):P?(0,o.jsxs)(a.A,{maxWidth:"lg",sx:{py:8},children:[(0,o.jsxs)(l.A,{sx:{textAlign:"center",mb:6},children:[(0,o.jsx)(p.A,{sx:{fontSize:80,color:"#4caf50",mb:2}}),(0,o.jsx)(i.A,{variant:"h3",sx:{fontWeight:600,color:"#5a3d35",mb:2},children:"Booking Confirmed!"}),(0,o.jsx)(i.A,{variant:"h6",sx:{color:"text.secondary",mb:3},children:"Thank you for choosing Luxe Staycations"}),(0,o.jsx)(d.A,{sx:{maxWidth:500,mx:"auto",mb:4,border:"2px solid #4caf50"},children:(0,o.jsxs)(u.A,{sx:{p:3},children:[(0,o.jsx)(i.A,{variant:"h6",sx:{fontWeight:600,color:"#4caf50",mb:2,textAlign:"center"},children:"Your Booking ID"}),(0,o.jsx)(l.A,{sx:{bgcolor:"#f8f9fa",p:2,borderRadius:1,border:"1px solid #e9ecef",mb:2,textAlign:"center"},children:(0,o.jsx)(i.A,{variant:"h5",sx:{fontWeight:700,color:"#5a3d35",fontFamily:"monospace",wordBreak:"break-all",lineHeight:1.2},children:P.id})}),(0,o.jsx)(i.A,{variant:"body2",sx:{color:"text.secondary",textAlign:"center"},children:"Please save this ID for future reference"}),"sent"===W&&(0,o.jsxs)(r.A,{severity:"success",sx:{mt:2,display:"flex",alignItems:"center",gap:1},children:[(0,o.jsx)(f.A,{sx:{fontSize:16}}),"Confirmation email sent to ",P.guestInfo.email]}),"not-configured"===W&&(0,o.jsxs)(r.A,{severity:"info",sx:{mt:2,display:"flex",alignItems:"center",gap:1},children:[(0,o.jsx)(f.A,{sx:{fontSize:16}}),"Email service not configured. Please contact admin to set up email notifications."]})]})})]}),(0,o.jsxs)(m.Ay,{container:!0,spacing:4,children:[(0,o.jsxs)(m.Ay,{item:!0,xs:12,md:8,children:[(0,o.jsx)(d.A,{sx:{mb:4,border:"2px solid #f3f4f6"},children:(0,o.jsxs)(u.A,{children:[(0,o.jsxs)(i.A,{variant:"h5",sx:{mb:3,fontWeight:600,color:"#d97706",display:"flex",alignItems:"center",gap:1},children:[(0,o.jsx)(y.A,{}),"Booking Details"]}),(0,o.jsxs)(m.Ay,{container:!0,spacing:3,children:[(0,o.jsxs)(m.Ay,{item:!0,xs:12,sm:6,children:[(0,o.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[(0,o.jsx)(k.A,{sx:{color:"text.secondary"}}),(0,o.jsx)(i.A,{variant:"body2",sx:{color:"text.secondary"},children:"Property"})]}),(0,o.jsx)(i.A,{variant:"h6",sx:{fontWeight:600},children:P.bookingDetails.propertyName}),(0,o.jsx)(i.A,{variant:"body2",sx:{color:"text.secondary"},children:P.bookingDetails.propertyLocation})]}),(0,o.jsxs)(m.Ay,{item:!0,xs:12,sm:6,children:[(0,o.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[(0,o.jsx)(b.A,{sx:{color:"text.secondary"}}),(0,o.jsx)(i.A,{variant:"body2",sx:{color:"text.secondary"},children:"Check-in"})]}),(0,o.jsx)(i.A,{variant:"h6",sx:{fontWeight:600},children:_(P.bookingDetails.checkIn)})]}),(0,o.jsxs)(m.Ay,{item:!0,xs:12,sm:6,children:[(0,o.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[(0,o.jsx)(b.A,{sx:{color:"text.secondary"}}),(0,o.jsx)(i.A,{variant:"body2",sx:{color:"text.secondary"},children:"Check-out"})]}),(0,o.jsx)(i.A,{variant:"h6",sx:{fontWeight:600},children:_(P.bookingDetails.checkOut)})]}),(0,o.jsxs)(m.Ay,{item:!0,xs:12,sm:6,children:[(0,o.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[(0,o.jsx)(A.A,{sx:{color:"text.secondary"}}),(0,o.jsx)(i.A,{variant:"body2",sx:{color:"text.secondary"},children:"Guests"})]}),(0,o.jsxs)(i.A,{variant:"h6",sx:{fontWeight:600},children:[P.bookingDetails.guests," ",1===parseInt(P.bookingDetails.guests)?"Guest":"Guests"]})]})]})]})}),(0,o.jsx)(d.A,{sx:{mb:4,border:"2px solid #f3f4f6"},children:(0,o.jsxs)(u.A,{children:[(0,o.jsxs)(i.A,{variant:"h5",sx:{mb:3,fontWeight:600,color:"#d97706",display:"flex",alignItems:"center",gap:1},children:[(0,o.jsx)(f.A,{}),"Guest Information"]}),(0,o.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:2,mb:3},children:[(0,o.jsxs)(g.A,{sx:{bgcolor:"#d97706",width:64,height:64},children:[P.guestInfo.firstName.charAt(0),P.guestInfo.lastName.charAt(0)]}),(0,o.jsxs)(l.A,{children:[(0,o.jsxs)(i.A,{variant:"h6",sx:{fontWeight:600},children:[P.guestInfo.firstName," ",P.guestInfo.lastName]}),(0,o.jsx)(i.A,{variant:"body2",sx:{color:"text.secondary"},children:"Primary Guest"})]})]}),(0,o.jsxs)(m.Ay,{container:!0,spacing:2,children:[(0,o.jsx)(m.Ay,{item:!0,xs:12,sm:6,children:(0,o.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[(0,o.jsx)(f.A,{sx:{fontSize:16,color:"text.secondary"}}),(0,o.jsx)(i.A,{variant:"body2",children:P.guestInfo.email})]})}),(0,o.jsx)(m.Ay,{item:!0,xs:12,sm:6,children:(0,o.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[(0,o.jsx)(j.A,{sx:{fontSize:16,color:"text.secondary"}}),(0,o.jsx)(i.A,{variant:"body2",children:P.guestInfo.phone})]})}),P.guestInfo.address&&(0,o.jsx)(m.Ay,{item:!0,xs:12,children:(0,o.jsxs)(l.A,{sx:{display:"flex",alignItems:"flex-start",gap:1},children:[(0,o.jsx)(k.A,{sx:{fontSize:16,color:"text.secondary",mt:.2}}),(0,o.jsxs)(i.A,{variant:"body2",children:[P.guestInfo.address,P.guestInfo.city&&", ".concat(P.guestInfo.city),P.guestInfo.country&&", ".concat(P.guestInfo.country)]})]})})]})]})})]}),(0,o.jsx)(m.Ay,{item:!0,xs:12,md:4,children:(0,o.jsx)(d.A,{sx:{border:"2px solid #f3f4f6"},children:(0,o.jsxs)(u.A,{children:[(0,o.jsxs)(i.A,{variant:"h5",sx:{mb:3,fontWeight:600,color:"#d97706",display:"flex",alignItems:"center",gap:1},children:[(0,o.jsx)(I.A,{}),"Payment Summary"]}),(0,o.jsxs)(l.A,{sx:{mb:3},children:[(0,o.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,o.jsx)(i.A,{variant:"body2",children:"Base Amount"}),(0,o.jsxs)(i.A,{variant:"body2",children:["₹",P.bookingDetails.total.toLocaleString()]})]}),(0,o.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,o.jsx)(i.A,{variant:"body2",children:"Service Fee"}),(0,o.jsxs)(i.A,{variant:"body2",children:["₹",(.1*P.bookingDetails.total).toLocaleString()]})]}),(null==(e=P.paymentDetails)?void 0:e.couponDiscount)&&P.paymentDetails.couponDiscount>0&&(0,o.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,o.jsxs)(i.A,{variant:"body2",sx:{color:"success.main"},children:["Coupon Discount (",P.paymentDetails.couponCode||"Applied",")"]}),(0,o.jsxs)(i.A,{variant:"body2",sx:{color:"success.main"},children:["-₹",P.paymentDetails.couponDiscount.toLocaleString()]})]}),(0,o.jsx)(x.A,{sx:{my:1}}),(0,o.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[(0,o.jsx)(i.A,{variant:"h6",sx:{fontWeight:600},children:"Total Paid"}),(0,o.jsxs)(i.A,{variant:"h6",sx:{fontWeight:600,color:"#d97706"},children:["₹",(null==(n=P.paymentDetails)||null==(t=n.finalAmount)?void 0:t.toLocaleString())||(1.1*P.bookingDetails.total).toLocaleString()]})]}),(0,o.jsx)(h.A,{label:"Payment Successful",color:"success",icon:(0,o.jsx)(p.A,{}),sx:{width:"100%"}})]}),(0,o.jsx)(x.A,{sx:{my:3}}),(0,o.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,o.jsx)(c.A,{variant:"outlined",startIcon:(0,o.jsx)(v.A,{}),onClick:()=>{var e,t,n;let o=(null==(e=P.paymentDetails)?void 0:e.finalAmount)||1.1*P.bookingDetails.total,s=(null==(t=P.paymentDetails)?void 0:t.couponDiscount)||0,a=null==(n=P.paymentDetails)?void 0:n.couponCode,i={bookingId:P.id,guestName:"".concat(P.guestInfo.firstName," ").concat(P.guestInfo.lastName),propertyName:P.bookingDetails.propertyName,checkIn:_(P.bookingDetails.checkIn),checkOut:_(P.bookingDetails.checkOut),baseAmount:P.bookingDetails.total,serviceFee:.1*P.bookingDetails.total,couponDiscount:s,couponCode:a,finalAmount:o,transactionId:P.transactionId},r=new Blob(["\nBooking Receipt\n===============\n\nBooking ID: ".concat(i.bookingId,"\nGuest: ").concat(i.guestName,"\nProperty: ").concat(i.propertyName,"\nCheck-in: ").concat(i.checkIn,"\nCheck-out: ").concat(i.checkOut,"\n\nPayment Breakdown:\nBase Amount: ₹").concat(i.baseAmount.toLocaleString(),"\nService Fee: ₹").concat(i.serviceFee.toLocaleString(),"\n").concat(s>0?"Coupon Discount (".concat(a,"): -₹").concat(s.toLocaleString()):"","\n").concat(s>0?"----------------------------------------":"","\nTotal Amount Paid: ₹").concat(i.finalAmount.toLocaleString(),"\n\nTransaction ID: ").concat(i.transactionId,"\n\nThank you for choosing Luxe Staycations!\n    ")],{type:"text/plain"}),c=window.URL.createObjectURL(r),l=document.createElement("a");l.href=c,l.download="receipt_".concat(P.id,".txt"),l.click(),window.URL.revokeObjectURL(c)},fullWidth:!0,children:"Download Receipt"}),(0,o.jsx)(c.A,{variant:"outlined",startIcon:(0,o.jsx)(S.A,{}),onClick:()=>{navigator.share?navigator.share({title:"My Booking Confirmation",text:"I've booked ".concat(P.bookingDetails.propertyName," for ").concat(_(P.bookingDetails.checkIn)," to ").concat(_(P.bookingDetails.checkOut)),url:window.location.href}):(navigator.clipboard.writeText(window.location.href),alert("Booking link copied to clipboard!"))},fullWidth:!0,children:"Share Booking"}),(0,o.jsx)(c.A,{variant:"contained",startIcon:(0,o.jsx)(D.A,{}),onClick:()=>L.push("/"),fullWidth:!0,sx:{background:"linear-gradient(45deg, #5a3d35, #d97706)","&:hover":{background:"linear-gradient(45deg, #4a332c, #b45309)"}},children:"Return to Home"}),(0,o.jsx)(c.A,{variant:"outlined",startIcon:(0,o.jsx)(w.A,{}),onClick:()=>{localStorage.setItem("currentBookingId",P.id),localStorage.setItem("guestEmail",P.guestInfo.email),L.push("/guest/dashboard")},fullWidth:!0,sx:{mt:1},children:"Manage This Booking"})]})]})})})]})]}):(0,o.jsxs)(a.A,{maxWidth:"lg",sx:{py:8},children:[(0,o.jsx)(r.A,{severity:"error",children:"Booking not found. Please check your booking ID."}),(0,o.jsx)(c.A,{variant:"contained",onClick:()=>L.push("/"),sx:{mt:2},children:"Return to Home"})]})}},62043:(e,t,n)=>{"use strict";n.d(t,{gm:()=>s});class o{static getInstance(){return o.instance||(o.instance=new o),o.instance}async initialize(){return Promise.resolve()}async sendEmail(e){try{return console.log("Sending email:",e),!0}catch(e){return console.error("Email sending failed:",e),!1}}async getTemplates(){return this.templates}async getTemplate(e){return this.templates.find(t=>t.id===e)||null}async createTemplate(e){let t={...e,id:Date.now().toString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return this.templates.push(t),t}async updateTemplate(e,t){let n=this.templates.findIndex(t=>t.id===e);return -1!==n?(this.templates[n]={...this.templates[n],...t,updated_at:new Date().toISOString()},this.templates[n]):null}async deleteTemplate(e){let t=this.templates.findIndex(t=>t.id===e);return -1!==t&&(this.templates.splice(t,1),!0)}getConfig(){return{smtpHost:"smtp.gmail.com",smtpPort:587,smtpSecure:!1,enableSSL:!1,smtpUser:"test@example.com",smtpPassword:"password",fromEmail:"noreply@luxestaycations.com",fromName:"Luxe Staycations",replyTo:"info@luxestaycations.com",testMode:!0,maxRetries:3,retryDelay:1e3}}async configure(e){return console.log("Configuring email service:",e),this.isConfigured=!0,!0}async reloadConfiguration(){console.log("Reloading email configuration")}async sendTestEmail(e){try{return{success:await this.sendEmail({to:e,subject:"Test Email - Luxe Staycations",content:"This is a test email from Luxe Staycations email service.",html:"<p>This is a test email from <strong>Luxe Staycations</strong> email service.</p>"})}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async sendBookingConfirmation(e){try{let t="Dear ".concat(e.guestName,", your booking ").concat(e.bookingId," for ").concat(e.propertyName," is confirmed. Check-in: ").concat(e.checkIn,", Check-out: ").concat(e.checkOut);return{success:await this.sendEmail({to:e.guestEmail,subject:"Booking Confirmation - Luxe Staycations",content:t,template:"booking-confirmation"})}}catch(e){return console.error("Booking confirmation email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async testConnection(){return console.log("Testing email connection..."),{success:!0,message:"Email connection test successful"}}async sendBookingCancellation(e){try{let t="Dear ".concat(e.guestName,", your booking ").concat(e.bookingId," has been cancelled. Refund will be processed within 5-7 business days.");return{success:await this.sendEmail({to:e.guestEmail,subject:"Booking Cancellation - Luxe Staycations",content:t,template:"booking-cancellation"})}}catch(e){return console.error("Booking cancellation email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async sendConsultationConfirmation(e){try{let t="Hi ".concat(e.name,", we have received your consultation request. Request ID: ").concat(e.requestId);return{success:await this.sendEmail({to:e.email,subject:"Consultation Request Confirmation - Luxe Staycations",content:t,template:"consultation-confirmation"})}}catch(e){return console.error("Consultation confirmation email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async sendSpecialRequestConfirmation(e){try{let t="Hi ".concat(e.guestName,", we have received your special request for ").concat(e.propertyName,". Request ID: ").concat(e.requestId);return{success:await this.sendEmail({to:e.email,subject:"Special Request Confirmation - Luxe Staycations",content:t,template:"special-request-confirmation"})}}catch(e){return console.error("Special request confirmation email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async sendContactFormThankYou(e){try{let t="Hi ".concat(e.name,", thank you for contacting us. We will get back to you soon.");return{success:await this.sendEmail({to:e.email,subject:"Thank You for Contacting Us - Luxe Staycations",content:t,template:"contact-thank-you"})}}catch(e){return console.error("Contact form thank you email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async sendPartnerRequestConfirmation(e){try{let t="Hi ".concat(e.contactName,", we have received your partner request for ").concat(e.businessName,". Request ID: ").concat(e.requestId);return{success:await this.sendEmail({to:e.email,subject:"Partner Request Confirmation - Luxe Staycations",content:t,template:"partner-request-confirmation"})}}catch(e){return console.error("Partner request confirmation email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async sendAdminNotification(e,t,n){try{let o="Admin notification: ".concat(e,". Data: ").concat(JSON.stringify(t));return{success:await this.sendEmail({to:n,subject:"Admin Notification - ".concat(e," - Luxe Staycations"),content:o,template:"admin-notification"})}}catch(e){return console.error("Admin notification email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}constructor(){this.templates=[],this.isConfigured=!1}}let s=o.getInstance()},85903:(e,t,n)=>{"use strict";n.d(t,{s:()=>r,v:()=>i});var o=n(95155),s=n(12115);let a=(0,s.createContext)(void 0);function i(e){let{children:t}=e,[i,r]=(0,s.useState)(null),[c,l]=(0,s.useState)({firstName:"",lastName:"",email:"",phone:"",address:"",city:"",country:"",specialRequests:""}),[d,u]=(0,s.useState)({checkIn:"",checkOut:"",guests:"",totalNights:0,total:0,propertyId:"",propertyName:"",propertyLocation:"",propertyImage:"",propertyPrice:0}),[m,g]=(0,s.useState)(null),[x,h]=(0,s.useState)([]);(0,s.useEffect)(()=>{{let e=localStorage.getItem("luxeBookings");if(e)try{h(JSON.parse(e))}catch(e){console.error("Error loading bookings from localStorage:",e)}}},[]),(0,s.useEffect)(()=>{localStorage.setItem("luxeBookings",JSON.stringify(x))},[x]);let p=async e=>{h(t=>[...t,e]),console.log("Booking added:",e);try{let t=await fetch("/api/bookings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({guestName:"".concat(e.guestInfo.firstName," ").concat(e.guestInfo.lastName),guestEmail:e.guestInfo.email,guestPhone:e.guestInfo.phone,propertyId:e.bookingDetails.propertyId,propertyName:e.bookingDetails.propertyName,checkIn:e.bookingDetails.checkIn,checkOut:e.bookingDetails.checkOut,guests:parseInt(e.bookingDetails.guests),amount:e.bookingDetails.total,status:e.status,paymentStatus:e.paymentStatus,specialRequests:e.guestInfo.specialRequests})});if(t.ok){let e=await t.json();console.log("Booking saved to Supabase:",e)}else console.error("Failed to save booking to Supabase:",await t.text())}catch(e){console.error("Error saving booking to Supabase:",e)}};return(0,o.jsx)(a.Provider,{value:{searchFormData:i,setSearchFormData:r,guestInfo:c,setGuestInfo:l,bookingDetails:d,setBookingDetails:u,completeBooking:m,setCompleteBooking:g,allBookings:x,addBooking:p,updateBooking:(e,t)=>{h(n=>n.map(n=>n.id===e?{...n,...t,updatedAt:new Date().toISOString()}:n)),console.log("Booking updated:",e,t),n.e(8991).then(n.bind(n,68991)).then(async n=>{let{bookingManager:o}=n;try{let n=await o.getById(e);if(n){var s,a,i,r,c,l,d,u;o.update(e,{guestName:t.guestInfo?"".concat(t.guestInfo.firstName||""," ").concat(t.guestInfo.lastName||"").trim():n.guestName,guestEmail:(null==(s=t.guestInfo)?void 0:s.email)||n.guestEmail,guestPhone:(null==(a=t.guestInfo)?void 0:a.phone)||n.guestPhone,property_id:(null==(i=t.bookingDetails)?void 0:i.propertyId)||n.property_id,checkIn:(null==(r=t.bookingDetails)?void 0:r.checkIn)||n.checkIn,checkOut:(null==(c=t.bookingDetails)?void 0:c.checkOut)||n.checkOut,guests:(null==(l=t.bookingDetails)?void 0:l.guests)?parseInt(t.bookingDetails.guests):"string"==typeof n.guests?parseInt(n.guests):n.guests,totalAmount:(null==(d=t.bookingDetails)?void 0:d.total)||n.totalAmount,status:"confirmed",specialRequests:(null==(u=t.guestInfo)?void 0:u.specialRequests)||n.specialRequests||""}),console.log("Successfully synced booking update to admin dashboard via DataManager")}}catch(e){console.error("Error syncing booking update to admin dashboard:",e)}})},getBookingById:e=>x.find(t=>t.id===e),clearBookingData:()=>{r(null),l({firstName:"",lastName:"",email:"",phone:"",address:"",city:"",country:"",specialRequests:""}),u({checkIn:"",checkOut:"",guests:"",totalNights:0,total:0,propertyId:"",propertyName:"",propertyLocation:"",propertyImage:"",propertyPrice:0}),g(null)},syncToAdminDashboard:()=>{console.log("Syncing booking data to admin dashboard..."),console.log("DataManager automatically handles Supabase sync and real-time updates")}},children:t})}function r(){let e=(0,s.useContext)(a);if(void 0===e)throw Error("useBookingContext must be used within a BookingProvider");return e}},89741:(e,t,n)=>{Promise.resolve().then(n.bind(n,13733))}},e=>{e.O(0,[5446,134,5493,5436,3077,8548,4211,2019,8441,1255,7358],()=>e(e.s=89741)),_N_E=e.O()}]);