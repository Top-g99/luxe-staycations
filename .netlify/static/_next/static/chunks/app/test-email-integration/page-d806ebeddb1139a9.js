(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2173,3115],{35189:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>A});var r=s(95155),n=s(12115),i=s(4474),a=s(97322),o=s(23315),c=s(29767),l=s(84578),u=s(80851),d=s(70690),m=s(78010),g=s(33077),h=s(28548),y=s(48563),v=s(36741),f=s(35205),x=s(76530);class p{static getInstance(){return p.instance||(p.instance=new p),p.instance}async initialize(){return Promise.resolve()}async getAll(){return this.deliveries}async getById(e){return this.deliveries.find(t=>t.id===e)||null}async create(e){let t={...e,id:Date.now().toString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return this.deliveries.push(t),t}async update(e,t){let s=this.deliveries.findIndex(t=>t.id===e);return -1!==s?(this.deliveries[s]={...this.deliveries[s],...t,updated_at:new Date().toISOString()},this.deliveries[s]):null}async delete(e){let t=this.deliveries.findIndex(t=>t.id===e);return -1!==t&&(this.deliveries.splice(t,1),!0)}async sendEmail(e,t,s){try{return await this.create({to:e,subject:t,content:s,status:"sent"}),console.log("Email sent:",{to:e,subject:t}),!0}catch(e){return console.error("Email sending failed:",e),!1}}async getDeliveryStatistics(){return{totalSent:this.deliveries.length,successfulDeliveries:this.deliveries.filter(e=>"sent"===e.status||"delivered"===e.status).length,failedDeliveries:this.deliveries.filter(e=>"failed"===e.status).length,deliveryRate:this.deliveries.length>0?this.deliveries.filter(e=>"sent"===e.status||"delivered"===e.status).length/this.deliveries.length*100:0}}async getRecentDeliveryLogs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this.deliveries.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()).slice(0,e)}async logEmailDelivery(e,t,s,r){return(await this.create({to:t,subject:s,content:r,status:"sent"})).id}constructor(){this.deliveries=[]}}let w=p.getInstance();var j=s(83115),S=s(62043);function A(){let[e,t]=(0,n.useState)(!1),[s,p]=(0,n.useState)([]),[A,b]=(0,n.useState)(null),[D,E]=(0,n.useState)([]);(0,n.useEffect)(()=>{k()},[]);let k=async()=>{try{await w.initialize();let e=await w.getDeliveryStatistics();b(e);let t=await w.getRecentDeliveryLogs(10);E(t),console.log("Test data loaded:",{stats:e,logs:t})}catch(s){console.error("Error loading test data:",s);let e=j.emailDeliveryService.getDeliveryStatistics(),t=j.emailDeliveryService.getRecentDeliveryLogs(10);b(e),E(t)}},I=async()=>{t(!0);let e=[];try{e.push({test:"Supabase Service Initialization",status:"running",message:"Testing..."}),p([...e]),await w.initialize(),e[0]={test:"Supabase Service Initialization",status:"success",message:"Supabase service initialized successfully"},p([...e]),e.push({test:"Email Service Configuration",status:"running",message:"Testing..."}),p([...e]);let t=S.gm.isConfigured;e[1]={test:"Email Service Configuration",status:t?"success":"warning",message:t?"Email service is configured":"Email service not configured (this is expected for testing)"},p([...e]),e.push({test:"Delivery Statistics",status:"running",message:"Testing..."}),p([...e]);let s=await w.getDeliveryStatistics();e[2]={test:"Delivery Statistics",status:"success",message:"Retrieved statistics: ".concat(s.total," total emails, ").concat(s.successful," successful, ").concat(s.failed," failed")},p([...e]),e.push({test:"Recent Logs",status:"running",message:"Testing..."}),p([...e]);let r=await w.getRecentDeliveryLogs(5);e[3]={test:"Recent Logs",status:"success",message:"Retrieved ".concat(r.length," recent delivery logs")},p([...e]),e.push({test:"Log Email Delivery",status:"running",message:"Testing..."}),p([...e]);let n=await w.logEmailDelivery("admin_notification","test@example.com","Test Email Integration","Test email content for integration testing");e[4]={test:"Log Email Delivery",status:n?"success":"error",message:n?"Email delivery logged with ID: ".concat(n):"Failed to log email delivery"},p([...e]),await k()}catch(s){let t="Unknown error";s instanceof y.A?t=s.message:"string"==typeof s?t=s:s&&"object"==typeof s&&"message"in s&&(t=String(s.message)),e.push({test:"Integration Test",status:"error",message:"Test failed: ".concat(t)}),p([...e])}finally{t(!1)}};return(0,r.jsxs)(a.A,{maxWidth:"lg",sx:{py:4},children:[(0,r.jsx)(o.A,{variant:"h4",gutterBottom:!0,children:"Email Integration Test"}),(0,r.jsx)(o.A,{variant:"body1",color:"text.secondary",sx:{mb:4},children:"Test the integration between email services and delivery tracking"}),(0,r.jsx)(c.A,{sx:{mb:4},children:(0,r.jsx)(l.A,{children:(0,r.jsxs)(u.A,{sx:{display:"flex",gap:2,alignItems:"center",mb:2},children:[(0,r.jsx)(d.A,{variant:"contained",startIcon:e?(0,r.jsx)(i.A,{size:20}):(0,r.jsx)(f.A,{}),onClick:I,disabled:e,children:e?"Running Tests...":"Run Integration Test"}),(0,r.jsx)(d.A,{variant:"outlined",startIcon:(0,r.jsx)(x.A,{}),onClick:k,children:"Refresh Data"})]})})}),s.length>0&&(0,r.jsx)(c.A,{sx:{mb:4},children:(0,r.jsxs)(l.A,{children:[(0,r.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:"Test Results"}),s.map((e,t)=>(0,r.jsxs)(m.A,{severity:(e=>{switch(e){case"success":return"success";case"error":return"error";case"warning":return"warning";default:return"default"}})(e.status),icon:(e=>{switch(e){case"success":return(0,r.jsx)(v.A,{color:"success"});case"error":return(0,r.jsx)(y.A,{color:"error"});case"warning":return(0,r.jsx)(y.A,{color:"warning"});default:return(0,r.jsx)(i.A,{size:20})}})(e.status),sx:{mb:1},children:[(0,r.jsx)(o.A,{variant:"subtitle2",children:e.test}),(0,r.jsx)(o.A,{variant:"body2",children:e.message})]},t))]})}),A&&(0,r.jsx)(c.A,{sx:{mb:4},children:(0,r.jsxs)(l.A,{children:[(0,r.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:"Delivery Statistics"}),(0,r.jsxs)(g.Ay,{container:!0,spacing:3,children:[(0,r.jsx)(g.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,r.jsxs)(u.A,{sx:{textAlign:"center"},children:[(0,r.jsx)(o.A,{variant:"h4",color:"primary",children:A.total}),(0,r.jsx)(o.A,{variant:"body2",color:"text.secondary",children:"Total Emails"})]})}),(0,r.jsx)(g.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,r.jsxs)(u.A,{sx:{textAlign:"center"},children:[(0,r.jsx)(o.A,{variant:"h4",color:"success.main",children:A.successful}),(0,r.jsx)(o.A,{variant:"body2",color:"text.secondary",children:"Successful"})]})}),(0,r.jsx)(g.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,r.jsxs)(u.A,{sx:{textAlign:"center"},children:[(0,r.jsx)(o.A,{variant:"h4",color:"error.main",children:A.failed}),(0,r.jsx)(o.A,{variant:"body2",color:"text.secondary",children:"Failed"})]})}),(0,r.jsx)(g.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,r.jsxs)(u.A,{sx:{textAlign:"center"},children:[(0,r.jsxs)(o.A,{variant:"h4",color:"info.main",children:[A.successRate,"%"]}),(0,r.jsx)(o.A,{variant:"body2",color:"text.secondary",children:"Success Rate"})]})})]})]})}),D.length>0&&(0,r.jsx)(c.A,{children:(0,r.jsxs)(l.A,{children:[(0,r.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:"Recent Delivery Logs"}),D.map((e,t)=>(0,r.jsxs)(u.A,{sx:{mb:2,p:2,border:"1px solid #e0e0e0",borderRadius:1},children:[(0,r.jsxs)(u.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[(0,r.jsx)(o.A,{variant:"subtitle2",children:e.type.replace("_"," ").toUpperCase()}),(0,r.jsx)(h.A,{icon:e.status.success?(0,r.jsx)(v.A,{}):(0,r.jsx)(y.A,{}),label:e.status.success?"Delivered":"Failed",color:e.status.success?"success":"error",size:"small"})]}),(0,r.jsxs)(o.A,{variant:"body2",color:"text.secondary",children:[(0,r.jsx)("strong",{children:"To:"})," ",e.recipient]}),(0,r.jsxs)(o.A,{variant:"body2",color:"text.secondary",children:[(0,r.jsx)("strong",{children:"Subject:"})," ",e.subject]}),(0,r.jsxs)(o.A,{variant:"body2",color:"text.secondary",children:[(0,r.jsx)("strong",{children:"Time:"})," ",new Date(e.createdAt).toLocaleString()]}),e.status.error&&(0,r.jsxs)(o.A,{variant:"body2",color:"error",children:[(0,r.jsx)("strong",{children:"Error:"})," ",e.status.error]})]},t))]})}),0===D.length&&(0,r.jsx)(c.A,{children:(0,r.jsx)(l.A,{children:(0,r.jsx)(o.A,{variant:"body1",color:"text.secondary",sx:{textAlign:"center",py:4},children:"No delivery logs found. Run the integration test to create some test data."})})})]})}},62043:(e,t,s)=>{"use strict";s.d(t,{gm:()=>n});class r{static getInstance(){return r.instance||(r.instance=new r),r.instance}async initialize(){return Promise.resolve()}async sendEmail(e){try{return console.log("Sending email:",e),!0}catch(e){return console.error("Email sending failed:",e),!1}}async getTemplates(){return this.templates}async getTemplate(e){return this.templates.find(t=>t.id===e)||null}async createTemplate(e){let t={...e,id:Date.now().toString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return this.templates.push(t),t}async updateTemplate(e,t){let s=this.templates.findIndex(t=>t.id===e);return -1!==s?(this.templates[s]={...this.templates[s],...t,updated_at:new Date().toISOString()},this.templates[s]):null}async deleteTemplate(e){let t=this.templates.findIndex(t=>t.id===e);return -1!==t&&(this.templates.splice(t,1),!0)}getConfig(){return{smtpHost:"smtp.gmail.com",smtpPort:587,smtpSecure:!1,enableSSL:!1,smtpUser:"test@example.com",smtpPassword:"password",fromEmail:"noreply@luxestaycations.com",fromName:"Luxe Staycations",replyTo:"info@luxestaycations.com",testMode:!0,maxRetries:3,retryDelay:1e3}}async configure(e){return console.log("Configuring email service:",e),this.isConfigured=!0,!0}async reloadConfiguration(){console.log("Reloading email configuration")}async sendTestEmail(e){try{return{success:await this.sendEmail({to:e,subject:"Test Email - Luxe Staycations",content:"This is a test email from Luxe Staycations email service.",html:"<p>This is a test email from <strong>Luxe Staycations</strong> email service.</p>"})}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async sendBookingConfirmation(e){try{let t="Dear ".concat(e.guestName,", your booking ").concat(e.bookingId," for ").concat(e.propertyName," is confirmed. Check-in: ").concat(e.checkIn,", Check-out: ").concat(e.checkOut);return{success:await this.sendEmail({to:e.guestEmail,subject:"Booking Confirmation - Luxe Staycations",content:t,template:"booking-confirmation"})}}catch(e){return console.error("Booking confirmation email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async testConnection(){return console.log("Testing email connection..."),{success:!0,message:"Email connection test successful"}}async sendBookingCancellation(e){try{let t="Dear ".concat(e.guestName,", your booking ").concat(e.bookingId," has been cancelled. Refund will be processed within 5-7 business days.");return{success:await this.sendEmail({to:e.guestEmail,subject:"Booking Cancellation - Luxe Staycations",content:t,template:"booking-cancellation"})}}catch(e){return console.error("Booking cancellation email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async sendConsultationConfirmation(e){try{let t="Hi ".concat(e.name,", we have received your consultation request. Request ID: ").concat(e.requestId);return{success:await this.sendEmail({to:e.email,subject:"Consultation Request Confirmation - Luxe Staycations",content:t,template:"consultation-confirmation"})}}catch(e){return console.error("Consultation confirmation email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async sendSpecialRequestConfirmation(e){try{let t="Hi ".concat(e.guestName,", we have received your special request for ").concat(e.propertyName,". Request ID: ").concat(e.requestId);return{success:await this.sendEmail({to:e.email,subject:"Special Request Confirmation - Luxe Staycations",content:t,template:"special-request-confirmation"})}}catch(e){return console.error("Special request confirmation email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async sendContactFormThankYou(e){try{let t="Hi ".concat(e.name,", thank you for contacting us. We will get back to you soon.");return{success:await this.sendEmail({to:e.email,subject:"Thank You for Contacting Us - Luxe Staycations",content:t,template:"contact-thank-you"})}}catch(e){return console.error("Contact form thank you email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async sendPartnerRequestConfirmation(e){try{let t="Hi ".concat(e.contactName,", we have received your partner request for ").concat(e.businessName,". Request ID: ").concat(e.requestId);return{success:await this.sendEmail({to:e.email,subject:"Partner Request Confirmation - Luxe Staycations",content:t,template:"partner-request-confirmation"})}}catch(e){return console.error("Partner request confirmation email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async sendAdminNotification(e,t,s){try{let r="Admin notification: ".concat(e,". Data: ").concat(JSON.stringify(t));return{success:await this.sendEmail({to:s,subject:"Admin Notification - ".concat(e," - Luxe Staycations"),content:r,template:"admin-notification"})}}catch(e){return console.error("Admin notification email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}constructor(){this.templates=[],this.isConfigured=!1}}let n=r.getInstance()},67890:(e,t,s)=>{Promise.resolve().then(s.bind(s,35189))},83115:(e,t,s)=>{"use strict";s.d(t,{emailDeliveryService:()=>n});class r{static getInstance(){return r.instance||(r.instance=new r),r.instance}async initialize(){return Promise.resolve()}async getAll(){return this.deliveries}async getById(e){return this.deliveries.find(t=>t.id===e)||null}async create(e){let t={...e,id:Date.now().toString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return this.deliveries.push(t),t}async update(e,t){let s=this.deliveries.findIndex(t=>t.id===e);return -1!==s?(this.deliveries[s]={...this.deliveries[s],...t,updated_at:new Date().toISOString()},this.deliveries[s]):null}async delete(e){let t=this.deliveries.findIndex(t=>t.id===e);return -1!==t&&(this.deliveries.splice(t,1),!0)}async sendEmail(e,t,s){try{return await this.create({to:e,subject:t,content:s,status:"sent"}),console.log("Email sent:",{to:e,subject:t}),!0}catch(e){return console.error("Email sending failed:",e),!1}}async sendConsultationRequestWithTracking(e){try{let t="Dear ".concat(e.name,", we have received your consultation request. Request ID: ").concat(e.requestId,". We will contact you soon.");return{success:await this.sendEmail(e.email,"Consultation Request Confirmation - Luxe Staycations",t)}}catch(e){return console.error("Consultation request email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async sendContactFormThankYouWithTracking(e){try{let t="Dear ".concat(e.name,", thank you for contacting us. We have received your message and will get back to you soon.");return{success:await this.sendEmail(e.email,"Thank You for Contacting Luxe Staycations",t)}}catch(e){return console.error("Contact form thank you email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async sendPartnerRequestWithTracking(e){try{let t="Dear ".concat(e.name,", thank you for your interest in partnering with us. We have received your application and will review it soon.");return{success:await this.sendEmail(e.email,"Partner Application Received - Luxe Staycations",t)}}catch(e){return console.error("Partner request email failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}getDeliveryStatistics(){return{totalSent:this.deliveries.length,successfulDeliveries:this.deliveries.filter(e=>"sent"===e.status||"delivered"===e.status).length,failedDeliveries:this.deliveries.filter(e=>"failed"===e.status).length,deliveryRate:this.deliveries.length>0?this.deliveries.filter(e=>"sent"===e.status||"delivered"===e.status).length/this.deliveries.length*100:0}}getRecentDeliveryLogs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this.deliveries.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()).slice(0,e)}constructor(){this.deliveries=[]}}let n=r.getInstance()}},e=>{e.O(0,[5446,134,5493,5436,3077,7247,8548,1248,8441,1255,7358],()=>e(e.s=67890)),_N_E=e.O()}]);